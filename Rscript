# Elaboración de la base para evaluar la asociación entre características maternas y cumplimiento de algunas guías específicas de la GPCEPP ####
# POsteriormente evaluación de la asociación entre cumplimiento y mortalidad materna, perinatal y trastornos hipertensivos ####


# Cohorte de embarazadas Colombia 2013-2017
library(rio)
library(readr)
library(dplyr)
library(haven)
library(plyr)
library(modeest)
library(dplyr)
library(data.table)

# Funciones: moda mínima

moda <- function(x){
  min(mfv(x, na_rm = TRUE))
}



# Estoy estableciendo la dirección en la que se encuentran mis archivos, solo para cuando no estoy en el proyecto:
  
#setwd("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología")

# Cargar base completa, con la que se este trabajando
# 
# load("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/completa_dg_base.RData")

# La idea es generar una variable de probable edad de concepción y, a partir de esta, construir la cohorte

# Creación cohorte de mujeres embarazadas a partir de las defunciones:

# Cargo los datos de defunción del 2011 al 2016

mortalidad_1 <- read_dta("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/Defunciones2011_2016_2.dta")

# Transformo "" en NA
# mortalidad_1[mortalidad_1==""] <- NA 

# Obtengo 1 275 657 observaciones con 92 variables.

# En primera instancia se eliminan dos observaciones que tienen los datos corridos y son poco confiables, y se hace de la variable del lugar de expedición una variable numérica:
  
mortalidad_p<-mortalidad_1[mortalidad_1$divlugarexpcer != "2013-07-09 00:00:00" & mortalidad_1$divlugarexpcer !="2017-02-16 00:00:00",]

# La variable es carahcter por lo que la transformo a numérica
mortalidad_p$divlugarexpcer <-  as.numeric(mortalidad_p$divlugarexpcer)

# Obtengo 1 275 655 observaciones con 92 variables

mortalidad_p<-mortalidad_p[mortalidad_p$idregisegusoci != "False",]

# Obtengo 1 275 651 observaciones con 92 variables, al quitar los datos faltantes de "idregisegusoci"(regime salud)

# Ahora cargo la segunda base de datos. Esta corresponde a las defunciones de 2016 al 2018. 

mortalidad_2 <- read_dta("Defunciones2017_2019_2.dta")

# Tiene 574 505 observaciones y 91 variables, 

# Unimos las dos bases

defunciones <- rbind(mortalidad_2,mortalidad_p[,-92])

# La suma debería dar
1275651+ 574505
# y en efecto se puede verificar que es asi:
nrow(defunciones)
# 1850156

# creo una variable con el año con los primeros 4 caracteres de la fecha de defunción
defunciones$año_defuncion <- substring(defunciones$fechordef,1,4)
# La vuelvo numérica
defunciones$año_defuncion <- as.numeric(defunciones$año_defuncion)
# Y cuento las observaciones que corresponde a todos los certificados de defunción entre el 2013 y el 2018
nrow(defunciones[defunciones$año_defuncion >= 2013 & defunciones$año_defuncion <=2018,])
# 1 441 140


# Estandarizo algunas fechas de la base conjunta de defunciones
defunciones$fechexped <- as.Date(defunciones$fechexped)
defunciones$fechnacifall <- as.Date(defunciones$fechnacifall)
defunciones$fecharegistro <- as.Date(defunciones$fecharegistro)
defunciones$fechordef <- as.Date(defunciones$fechordef)


# Ahora, construyo la cohorte de mujeres embarazadas quienes tuvieron una muerte fetal de acuerdo a las variables idtipodefunc==1 & in_mad==1
# Primero las observaciones para las que la madre contaba con id y las muertes fetales por separado:
  
nrow(subset(defunciones,defunciones$madreid!=1));nrow(subset(defunciones,defunciones$idtipodefunc ==1))

# 383 744
# 335 342

# Ahora con las dos condiciones (madre ID diferente a 1 y muerte fetal igual a 1)

defunciones_id <-subset(defunciones,defunciones$madreid !=1 & defunciones$idtipodefunc ==1)
nrow(defunciones_id)

# obtengo 335340, sí que son fetales o de 7 días o menos porque tienen asociado el id materno. 
# Estas son las mujeres embarazadas que se identificaron por medio del certificado de defunción


# Aquí hay un problema con el script del Dr Giancarlo, el dice que estos 335 340 fallecieron entre 2013 y 2018 pero parece que 
# la fecha no está especificada

nrow(defunciones_id[defunciones_id$año_defuncion >= 2013 & defunciones_id$año_defuncion <=2018,])
# Tengo que 254 427 observaciones de las defunciones fallecieron entre 2013 y el 2018


# Voy a generar la fecha de concepción

# Ahora procedemos a depurar y dejar unicamente las madres que pudieron concebir entre el 2013 y el 2018, para esto construyo una variable de probable fecha de concepción restando a la fecha de de defunción, la edad gestacional. 
# Tiempo de getación en semanas
defunciones_id$edad_gestacional_calculada <- defunciones_id$tiegessemmad 
# Las que cuentan con el tiempo de gestación:
defunciones_id$edad_gestacional_calculada[defunciones_id$edad_gestacional_calculada == -1] <- NA
# Fecha probable de concepción 
defunciones_id$fecha_concepcion <- defunciones_id$fechordef - (defunciones_id$edad_gestacional_calculada*7) # Son los días en una semana, porque a la variable FECHORDEF es más fácil restarle el tiempo en segundos

# Sigo aquí con ls 335 340 observaciones, pero ya con fecha de concepción
# Aquí defino una cohorte de mujeres embarazadas cuya concepción fue entre el 2013 y el 2018

cohorte_defuncion <- subset(defunciones_id,defunciones_id$fecha_concepcion > "2012-12-31" & defunciones_id$fecha_concepcion < "2018-01-01")
# Yo tengo que 176 817 observaciones fueron mujeres embarazadas cuya fecha de concepción fue entre 2013 y 2018
# Estas hacen parte de las mujeres embarazadas identificadas por medio del certificado de defunción #####

defunciones_id$año_concepcion <- substring(defunciones_id$fecha_concepcion,1,4)
defunciones_id$año_concepcion <- as.numeric(defunciones_id$año_concepcion)
cohorte_defuncion_dg <- subset(defunciones_id,defunciones_id$año_concepcion != 2008 & defunciones_id$año_concepcion != 2009 & defunciones_id$año_concepcion != 2010|is.na(defunciones_id$año_concepcion) == TRUE)
# Esta cohorte es la misma que tiene el doctor Giancarlo al quitar los datos menores al 2011. 


# Dado que el dr Giancarlo trabajo con los 335 340 y después saca a las embarazadas.
# Revisión de los 335340 en términos de variables y demás para poder hacer el append con la de nacimientos más facilmente ####


# Eliminar la 1, todos los valores son 1 excepto algunos errores que son los valores de la madre_id
colnames(defunciones_id)[2] <- "madre_id"
colnames(defunciones_id)[3] <- "id_nacido_vivo_o_mortinato"
colnames(defunciones_id)[4] <- "area_defuncion"
defunciones_id$area_defuncion <- factor(defunciones_id$area_defuncion, levels = c(1:3),labels =c("cabecera","centro_poblado","rural_disperso"), ordered = TRUE)
# Eliminar la 5,6 y 7. Es una pregunta para mujeres en edad fertil
colnames(defunciones_id)[8] <- "sitio_parto"
defunciones_id$sitio_parto[defunciones_id$sitio_parto==1|defunciones_id$sitio_parto==2] <- 1
defunciones_id$sitio_parto[defunciones_id$sitio_parto==3] <- 2
defunciones_id$sitio_parto[defunciones_id$sitio_parto==4|defunciones_id$sitio_parto==5|defunciones_id$sitio_parto==6] <- 3
defunciones_id$sitio_parto[defunciones_id$sitio_parto==7] <- NA
defunciones_id$sitio_parto <- factor(defunciones_id$sitio_parto, levels = c(1:3),labels =c("institucion_salud","domicilio","otro"), ordered = TRUE)
colnames(defunciones_id)[9] <- "asistencia_medica_durante_muerte"
defunciones_id$asistencia_medica_durante_muerte <- factor(defunciones_id$asistencia_medica_durante_muerte, levels = c(1,2), labels = c("si", "no"), ordered = TRUE)
colnames(defunciones_id)[10] <- "multiplicidad"
defunciones_id$multiplicidad <- factor(defunciones_id$multiplicidad, levels = c(1,2,3,4,5), labels = c("simple", "doble", "triple", "cuadruple_o_mas","ignorado"), ordered = TRUE)
# Borrar 11, tiene solo 96 observaciones y en otra pregunta se sabe si es violenta o no
colnames(defunciones_id)[12] <- "tipo_parto"
defunciones_id$tipo_parto <- factor(defunciones_id$tipo_parto, levels = c(1,2,3,4), labels = c("espontaneo", "cesarea", "instrumentado", "desconocido"), ordered = TRUE)
# Eliminar la 13, es comuna/localidad, demasiado especifica
colnames(defunciones_id)[14] <- "relacion_parto_muerte"
defunciones_id$relacion_parto_muerte <- factor(defunciones_id$relacion_parto_muerte, levels = c(1,2,3,4), labels = c("antes", "despues", "durante", "desconocido"), ordered = TRUE)
colnames(defunciones_id)[15] <- "municipio_nacimiento_defuncion"
defunciones_id$municipio_nacimiento_defuncion <- factor(defunciones_id$municipio_nacimiento_defuncion, 
                                             levels=c(5001,5002,5004,5021,5030,5031,5034,5036,5038,5040,5042,5044,5045,5051,5055,5059,5079,5086,5088,5091,5093,5101,5107,5113,5120,5125,5129,5134,5138,5142,5145,5147,5148,5150,5154,5172,5190,5197,5206,5209,5212,5234,5237,5240,5250,5264,5266,5282,5284,5306,5308,5310,5313,5315,5318,5321,5347,5353,5360,5361,5364,5368,5376,5380,5390,5400,5411,5425,5440,5467,5475,5480,5483,5490,5495,5501,5541,5543,5576,5579,5585,5591,5604,5607,5615,5628,5631,5642,5647,5649,5652,5656,5658,5659,5660,5664,5665,5667,5670,5674,5679,5686,5690,5697,5736,5756,5761,5789,5790,5792,5809,5819,5837,5842,5847,5854,5856,5858,5861,5873,5885,5887,5890,5893,5895,8001,8078,8137,8141,8296,8372,8421,8433,8436,8520,8549,8558,8560,8573,8606,8634,8638,8675,8685,8758,8770,8832,8849
                                                      ,11001,13001,13006,13030,13042,13052,13062,13074,13140,13160,13188,13212,13222,13244,13248,13268,13300,13430,13433,13440,13442,13458,13468,13490,13473,13549,13580,13600,13620,13647,13650,13654,13655,13657,13667,13670,13673,13683,13688,13744,13760,13780,13810,13836,13838,13873,13894,15001,15022,15047,15051,15087,15090,15092,15097,15104,15106,15109,15114,15131,15135,15162,15172,15176,15180,15183,15185,15187,15189,15204,15212,15215,15218,15223,15224,15226,15232,15236,15238,15244,15248,15272,15276,15293,15296,15299,15317,15322,15325,15332,15362,15367,15368,15377,15380,15401,15403,15407,15425,15442,15455,15464,15466,15469,15476,15480,15491,15494,15500,15507,15511,15514,15516,15518,15522,15531,15533,15537,15542,15550,15572,15580,15599,
                                                      15600,15621,15632,15638,15646,15660,15664,15667,15673,15676,15681,15686,15690,15693,15696,15720,15723,15740,15753,15755,15757,15759,15761,15762,15763,15764,15774,15776,15778,15790,15798,15804,15806,15808,15810,15814,15816,15820,15822,15832,15835,15837,15839,15842,15861,15879,15897,17001,17013,17042,17050,17088,17174,17272,17380,17388,17433,17442,17444,17446,17486,17495,17513,17524,17541,17614,17616,17653,17662,17665,17777,17867,17873,17877,18001,18029,18094,18150,18205,18247,18256,18410,18460,18479,18592,18610,18753,18756,18785,18860,19001,19022,19050,19075,19100,19110,19130,19137,19142,19212,19256,19290,19300,19318,19355,19364,19392,19397,19418,19450,19455,19473,19513,19517,19532,19533,19548,19573,19585,19622,19693,19698,19701,
                                                      19743,19760,19780,19785,19807,19809,19821,19824,19845,20001,20011,20013,20032,20045,20060,20175,20178,20228,20238,20250,20295,20310,20383,20400,20443,20517,20550,20570,20614,20621,20710,20750,20770,20787,23001,23068,23079,23090,23162,23168,23182,23189,23300,23350,23417,23419,23464,23466,23500,23555,23570,23574,23580,23586,23660,23670,23672,23675,23678,23686,23807,23855,25001,25019,25035,25040,25053,25086,25095,25099,25120,25123,25126,25148,25151,25154,25168,25175,25178,25181,25183,25200,25214,25224,25245,25258,25260,25269,25279,25281,25286,25288,25290,25293,25295,25297,25299,25307,25312,25317,25320,25322,25324,25326,25328,25335,25339,25368,25372,25377,25386,25394,25398,25402,25407,25426,25430,25436,25438,25473,25483,25486,25488,
                                                      25489,25491,25506,25513,25518,25524,25530,25535,25572,25580,25592,25594,25596,25599,25612,25645,25649,25653,25658,25662,25718,25736,25740,25743,25745,25754,25758,25769,25772,25777,25779,25781,25785,25793,25797,25799,25805,25807,25815,25817,25823,25839,25841,25843,25845,25851,25862,25867,25871,25873,25875,25878,25885,25898,25899,27001,27006,27025,27050,27073,27075,27077,27099,27135,27150,27160,27205,27245,27250,27361,27372,27413,27425,27430,27450,27491,27495,27580,27600,27615,27660,27745,27787,27800,27810,41001,41006,41013,41016,41020,41026,41078,41132,41206,41244,41298,41306,41319,41349,41357,41359,41378,41396,41483,41503,41518,41524,41530,41548,41551,41615,41660,41668,41676,41770,41791,41797,41799,41801,41807,41872,41885,44001,
                                                      44035,44078,44090,44098,44110,44279,44378,44420,44430,44560,44650,44847,44855,44874,47001,47030,47053,47058,47161,47170,47189,47205,47245,47258,47268,47288,47318,47460,47541,47545,47551,47555,47570,47605,47660,47675,47692,47703,47707,47720,47745,47798,47960,47980,50001,50006,50110,50124,50150,50223,50226,50245,50251,50270,50287,50313,50318,50325,50330,50350,50370,50400,50450,50568,50573,50577,50590,50606,50680,50683,50686,50689,50711,52001,52019,52022,52036,52051,52079,52083,52110,52203,52207,52210,52215,52224,52227,52233,52240,52250,52254,52256,52258,52260,52287,52317,52320,52323,52352,52354,52356,52378,52381,52385,52390,52399,52405,52411,52418,52427,52435,52473,52480,52490,52506,52520,52540,52560,52565,52573,52585,52612,52621,
                                                      52678,52683,52685,52687,52693,52694,52696,52699,52720,52786,52788,52835,52838,52885,54001,54003,54051,54099,54109,54125,54128,54172,54174,54206,54223,54239,54245,54250,54261,54313,54344,54347,54377,54385,54398,54405,54418,54480,54498,54518,54520,54553,54599,54660,54670,54673,54680,54720,54743,54800,54810,54820,54871,54874,63001,63111,63130,63190,63212,63272,63302,63401,63470,63548,63594,63690,66001,66045,66075,66088,66170,66318,66383,66400,66440,66456,66572,66594,66682,66687,68001,68013,68020,68051,68077,68079,68081,68092,68101,68121,68132,68147,68152,68160,68162,68167,68169,68176,68179,68190,68207,68209,68211,68217,68229,68235,68245,68250,68255,68264,68266,68271,68276,68296,68298,68307,68318,68320,68322,68324,68327,68344,68368,
                                                      68370,68377,68385,68397,68406,68418,68425,68432,68444,68464,68468,68498,68500,68502,68522,68524,68533,68547,68549,68572,68573,68575,68615,68655,68669,68673,68679,68682,68684,68686,68689,68705,68720,68745,68755,68770,68773,68780,68820,68855,68861,68867,68872,68895,70001,70110,70124,70204,70215,70221,70230,70233,70235,70265,70400,70418,70429,70473,70508,70523,70670,70678,70702,70708,70713,70717,70742,70771,70820,70823,73001,73024,73026,73030,73043,73055,73067,73124,73148,73152,73168,73200,73217,73226,73236,73268,73270,73275,73283,73319,73347,73349,73352,73408,73411,73443,73449,73461,73483,73504,73520,73547,73555,73563,73585,73616,73622,73624,73671,73675,73678,73686,73770,73854,73861,73870,73873,76001,76020,76036,76041,76054,76100,
                                                      76109,76111,76113,76122,76126,76130,76147,76233,76243,76246,76248,76250,76275,76306,76318,76364,76377,76400,76403,76497,76520,76563,76606,76616,76622,76670,76736,76823,76828,76834,76845,76863,76869,76890,76892,76895,81001,81065,81220,81300,81591,81736,81794,85001,85010,85015,85125,85136,85139,85162,85225,85230,85250,85263,85279,85300,85315,85325,85400,85410,85430,85440,86001,86219,86320,86568,86569,86571,86573,86749,86755,86757,86760,86865,86885,88001,88564,91001,91263,91405,91407,91430,91460,91530,91536,91540,91669,91798,94001,94343,94663,94883,94884,94885,94886,94887,94888,95001,95015,95025,95200,97001,97161,97511,97666,97777,97889,99001,99524,99624,99773),
                                             labels = c("MEDELLIN","ABEJORRAL","ABRIAQUI","ALEJANDRIA","AMAGA","AMALFI","ANDES","ANGELOPOLIS","ANGOSTURA","ANORI","SANTAFEDEANTIOQUIA","ANZA","APARTADO","ARBOLETES","ARGELIA","ARMENIA","BARBOSA","BELMIRA","BELLO","BETANIA","BETULIA","CIUDADBOLIVAR","BRICEÑO","BURITICA","CACERES","CAICEDO","CALDAS","CAMPAMENTO","CAÑASGORDAS","CARACOLI","CARAMANTA","CAREPA","ELCARMENDEVIBORAL","CAROLINA","CAUCASIA","CHIGORODO","CISNEROS","COCORNA","CONCEPCION","CONCORDIA","COPACABANA","DABEIBA","DONMATIAS","EBEJICO","ELBAGRE","ENTRERRIOS","ENVIGADO","FREDONIA","FRONTINO","GIRALDO","GIRARDOTA","GOMEZPLATA","GRANADA","GUADALUPE","GUARNE","GUATAPE","HELICONIA","HISPANIA","ITAGUI","ITUANGO","JARDIN","JERICO","LACEJA","LAESTRELLA","LAPINTADA","LAUNION","LIBORINA",
                                                        "MACEO","MARINILLA","MONTEBELLO","MURINDO","MUTATA","NARIÑO","NECOCLI","NECHI","OLAYA","PEÐOL","PEQUE","PUEBLORRICO","PUERTOBERRIO","PUERTONARE","PUERTOTRIUNFO","REMEDIOS","RETIRO","RIONEGRO","SABANALARGA","SABANETA","SALGAR","SANANDRESDECUERQUIA","SANCARLOS","SANFRANCISCO","SANJERONIMO","SANJOSEDELAMONTAÑA","SANJUANDEURABA","SANLUIS","SANPEDRO","SANPEDRODEURABA","SANRAFAEL","SANROQUE","SANVICENTE","SANTABARBARA","SANTAROSADEOSOS","SANTODOMINGO","ELSANTUARIO","SEGOVIA","SONSON","SOPETRAN","TAMESIS","TARAZA","TARSO","TITIRIBI","TOLEDO","TURBO","URAMITA","URRAO","VALDIVIA","VALPARAISO","VEGACHI","VENECIA","VIGIADELFUERTE","YALI","YARUMAL","YOLOMBO","YONDO","ZARAGOZA","BARRANQUILLA","BARANOA","CAMPODELACRUZ","CANDELARIA","GALAPA","JUANDEACOSTA",
                                                        "LURUACO","MALAMBO","MANATI","PALMARDEVARELA","PIOJO","POLONUEVO","PONEDERA","PUERTOCOLOMBIA","REPELON","SABANAGRANDE","SABANALARGA","SANTALUCIA","SANTOTOMAS","SOLEDAD","SUAN","TUBARA","USIACURI","BOGOTA,D.C.","CARTAGENA","ACHI","ALTOSDELROSARIO","ARENAL","ARJONA","ARROYOHONDO","BARRANCODELOBA","CALAMAR","CANTAGALLO","CICUCO","CORDOBA","CLEMENCIA","ELCARMENDEBOLIVAR","ELGUAMO","ELPEÑON","HATILLODELOBA","MAGANGUE","MAHATES","MARGARITA","MARIALABAJA","MONTECRISTO","MOMPOS","NOROSI","MORALES","PINILLOS","REGIDOR","RIOVIEJO","SANCRISTOBAL","SANESTANISLAO","SANFERNANDO","SANJACINTO","SANJACINTODELCAUCA","SANJUANNEPOMUCENO","SANMARTINDELOBA","SANPABLO","SANTACATALINA","SANTAROSA","SANTAROSADELSUR","SIMITI","SOPLAVIENTO","TALAIGUANUEVO","TIQUISIO",
                                                        "TURBACO","TURBANA","VILLANUEVA","ZAMBRANO","TUNJA","ALMEIDA","AQUITANIA","ARCABUCO","BELEN","BERBEO","BETEITIVA","BOAVITA","BOYACA","BRICEÑO","BUENAVISTA","BUSBANZA","CALDAS","CAMPOHERMOSO","CERINZA","CHINAVITA","CHIQUINQUIRA","CHISCAS","CHITA","CHITARAQUE","CHIVATA","CIENEGA","COMBITA","COPER","CORRALES","COVARACHIA","CUBARA","CUCAITA","CUITIVA","CHIQUIZA","CHIVOR","DUITAMA","ELCOCUY","ELESPINO","FIRAVITOBA","FLORESTA","GACHANTIVA","GAMEZA","GARAGOA","GUACAMAYAS","GUATEQUE","GUAYATA","GsICAN","IZA","JENESANO","JERICO","LABRANZAGRANDE","LACAPILLA","LAVICTORIA","LAUVITA","VILLADELEYVA","MACANAL","MARIPI","MIRAFLORES","MONGUA","MONGUI","MONIQUIRA","MOTAVITA","MUZO","NOBSA","NUEVOCOLON","OICATA","OTANCHE","PACHAVITA","PAEZ","PAIPA","PAJARITO",
                                                        "PANQUEBA","PAUNA","PAYA","PAZDERIO","PESCA","PISBA","PUERTOBOYACA","QUIPAMA","RAMIRIQUI","RAQUIRA","RONDON","SABOYA","SACHICA","SAMACA","SANEDUARDO","SANJOSEDEPARE","SANLUISDEGACENO","SANMATEO","SANMIGUELDESEMA","SANPABLODEBORBUR","SANTANA","SANTAMARIA","SANTAROSADEVITERBO","SANTASOFIA","SATIVANORTE","SATIVASUR","SIACHOQUE","SOATA","SOCOTA","SOCHA","SOGAMOSO","SOMONDOCO","SORA","SOTAQUIRA","SORACA","SUSACON","SUTAMARCHAN","SUTATENZA","TASCO","TENZA","TIBANA","TIBASOSA","TINJACA","TIPACOQUE","TOCA","TOGsI","TOPAGA","TOTA","TUNUNGUA","TURMEQUE","TUTA","TUTAZA","UMBITA","VENTAQUEMADA","VIRACACHA","ZETAQUIRA","MANIZALES","AGUADAS","ANSERMA","ARANZAZU","BELALCAZAR","CHINCHINA","FILADELFIA","LADORADA","LAMERCED","MANZANARES","MARMATO","MARQUETALIA",
                                                        "MARULANDA","NEIRA","NORCASIA","PACORA","PALESTINA","PENSILVANIA","RIOSUCIO","RISARALDA","SALAMINA","SAMANA","SANJOSE","SUPIA","VICTORIA","VILLAMARIA","VITERBO","FLORENCIA","ALBANIA","BELENDELOSANDAQUIES","CARTAGENADELCHAIRA","CURILLO","ELDONCELLO","ELPAUJIL","LAMONTAÑITA","MILAN","MORELIA","PUERTORICO","SANJOSEDELFRAGUA","SANVICENTEDELCAGUAN","SOLANO","SOLITA","VALPARAISO","POPAYAN","ALMAGUER","ARGELIA","BALBOA","BOLIVAR","BUENOSAIRES","CAJIBIO","CALDONO","CALOTO","CORINTO","ELTAMBO","FLORENCIA","GUACHENE","GUAPI","INZA","JAMBALO","LASIERRA","LAVEGA","LOPEZ","MERCADERES","MIRANDA","MORALES","PADILLA","PAEZ","PATIA","PIAMONTE","PIENDAMO","PUERTOTEJADA","PURACE","ROSAS","SANSEBASTIAN","SANTANDERDEQUILICHAO","SANTAROSA","SILVIA","SOTARA","SUAREZ",
                                                        "SUCRE","TIMBIO","TIMBIQUI","TORIBIO","TOTORO","VILLARICA","VALLEDUPAR","AGUACHICA","AGUSTINCODAZZI","ASTREA","BECERRIL","BOSCONIA","CHIMICHAGUA","CHIRIGUANA","CURUMANI","ELCOPEY","ELPASO","GAMARRA","GONZALEZ","LAGLORIA","LAJAGUADEIBIRICO","MANAURE","PAILITAS","PELAYA","PUEBLOBELLO","RIODEORO","LAPAZ","SANALBERTO","SANDIEGO","SANMARTIN","TAMALAMEQUE","MONTERIA","AYAPEL","BUENAVISTA","CANALETE","CERETE","CHIMA","CHINU","CIENAGADEORO","COTORRA","LAAPARTADA","LORICA","LOSCORDOBAS","MOMIL","MONTELIBANO","MOÑITOS","PLANETARICA","PUEBLONUEVO","PUERTOESCONDIDO","PUERTOLIBERTADOR","PURISIMA","SAHAGUN","SANANDRESSOTAVENTO","SANANTERO","SANBERNARDODELVIENTO","SANCARLOS","SANPELAYO","TIERRALTA","VALENCIA","AGUADEDIOS","ALBAN","ANAPOIMA","ANOLAIMA","ARBELAEZ",
                                                        "BELTRAN","BITUIMA","BOJACA","CABRERA","CACHIPAY","CAJICA","CAPARRAPI","CAQUEZA","CARMENDECARUPA","CHAGUANI","CHIA","CHIPAQUE","CHOACHI","CHOCONTA","COGUA","COTA","CUCUNUBA","ELCOLEGIO","ELPEÑON","ELROSAL","FACATATIVA","FOMEQUE","FOSCA","FUNZA","FUQUENE","FUSAGASUGA","GACHALA","GACHANCIPA","GACHETA","GAMA","GIRARDOT","GRANADA","GUACHETA","GUADUAS","GUASCA","GUATAQUI","GUATAVITA","GUAYABALDESIQUIMA","GUAYABETAL","GUTIERREZ","JERUSALEN","JUNIN","LACALERA","LAMESA","LAPALMA","LAPEÑA","LAVEGA","LENGUAZAQUE","MACHETA","MADRID","MANTA","MEDINA","MOSQUERA","NARIÑO","NEMOCON","NILO","NIMAIMA","NOCAIMA","VENECIA","PACHO","PAIME","PANDI","PARATEBUENO","PASCA","PUERTOSALGAR","PULI","QUEBRADANEGRA","QUETAME","QUIPILE","APULO","RICAURTE","SANANTONIODELTEQUENDAMA",
                                                        "SANBERNARDO","SANCAYETANO","SANFRANCISCO","SANJUANDERIOSECO","SASAIMA","SESQUILE","SIBATE","SILVANIA","SIMIJACA","SOACHA","SOPO","SUBACHOQUE","SUESCA","SUPATA","SUSA","SUTATAUSA","TABIO","TAUSA","TENA","TENJO","TIBACUY","TIBIRITA","TOCAIMA","TOCANCIPA","TOPAIPI","UBALA","UBAQUE","VILLADESANDIEGODEUBATE","UNE","UTICA","VERGARA","VIANI","VILLAGOMEZ","VILLAPINZON","VILLETA","VIOTA","YACOPI","ZIPACON","ZIPAQUIRA","QUIBDO","ACANDI","ALTOBAUDO","ATRATO","BAGADO","BAHIASOLANO","BAJOBAUDO","BOJAYA","ELCANTONDELSANPABLO","CARMENDELDARIEN","CERTEGUI","CONDOTO","ELCARMENDEATRATO","ELLITORALDELSANJUAN","ISTMINA","JURADO","LLORO","MEDIOATRATO","MEDIOBAUDO","MEDIOSANJUAN","NOVITA","NUQUI","RIOIRO","RIOQUITO","RIOSUCIO","SANJOSEDELPALMAR","SIPI","TADO","UNGUIA",
                                                        "UNIONPANAMERICANA","NEIVA","ACEVEDO","AGRADO","AIPE","ALGECIRAS","ALTAMIRA","BARAYA","CAMPOALEGRE","COLOMBIA","ELIAS","GARZON","GIGANTE","GUADALUPE","HOBO","IQUIRA","ISNOS","LAARGENTINA","LAPLATA","NATAGA","OPORAPA","PAICOL","PALERMO","PALESTINA","PITAL","PITALITO","RIVERA","SALADOBLANCO","SANAGUSTIN","SANTAMARIA","SUAZA","TARQUI","TESALIA","TELLO","TERUEL","TIMANA","VILLAVIEJA","YAGUARA","RIOHACHA","ALBANIA","BARRANCAS","DIBULLA","DISTRACCION","ELMOLINO","FONSECA","HATONUEVO","LAJAGUADELPILAR","MAICAO","MANAURE","SANJUANDELCESAR","URIBIA","URUMITA","VILLANUEVA","SANTAMARTA","ALGARROBO","ARACATACA","ARIGUANI","CERROSANANTONIO","CHIBOLO","CIENAGA","CONCORDIA","ELBANCO","ELPIÑON","ELRETEN","FUNDACION","GUAMAL","NUEVAGRANADA","PEDRAZA","PIJIÑODELCARMEN",
                                                        "PIVIJAY","PLATO","PUEBLOVIEJO","REMOLINO","SABANASDESANANGEL","SALAMINA","SANSEBASTIANDEBUENAVISTA","SANZENON","SANTAANA","SANTABARBARADEPINTO","SITIONUEVO","TENERIFE","ZAPAYAN","ZONABANANERA","VILLAVICENCIO","ACACIAS","BARRANCADEUPIA","CABUYARO","CASTILLALANUEVA","CUBARRAL","CUMARAL","ELCALVARIO","ELCASTILLO","ELDORADO","FUENTEDEORO","GRANADA","GUAMAL","MAPIRIPAN","MESETAS","LAMACARENA","URIBE","LEJANIAS","PUERTOCONCORDIA","PUERTOGAITAN","PUERTOLOPEZ","PUERTOLLERAS","PUERTORICO","RESTREPO","SANCARLOSDEGUAROA","SANJUANDEARAMA","SANJUANITO","SANMARTIN","VISTAHERMOSA","PASTO","ALBAN","ALDANA","ANCUYA","ARBOLEDA","BARBACOAS","BELEN","BUESACO","COLON","CONSACA","CONTADERO","CORDOBA","CUASPUD","CUMBAL","CUMBITARA","CHACHAGsI","ELCHARCO","ELPEÑOL","ELROSARIO",
                                                        "ELTABLONDEGOMEZ","ELTAMBO","FUNES","GUACHUCAL","GUAITARILLA","GUALMATAN","ILES","IMUES","IPIALES","LACRUZ","LAFLORIDA","LALLANADA","LATOLA","LAUNION","LEIVA","LINARES","LOSANDES","MAGsI","MALLAMA","MOSQUERA","NARIÑO","OLAYAHERRERA","OSPINA","FRANCISCOPIZARRO","POLICARPA","POTOSI","PROVIDENCIA","PUERRES","PUPIALES","RICAURTE","ROBERTOPAYAN","SAMANIEGO","SANDONA","SANBERNARDO","SANLORENZO","SANPABLO","SANPEDRODECARTAGO","SANTABARBARA","SANTACRUZ","SAPUYES","TAMINANGO","TANGUA","SANANDRESDETUMACO","TUQUERRES","YACUANQUER","CUCUTA","ABREGO","ARBOLEDAS","BOCHALEMA","BUCARASICA","CACOTA","CACHIRA","CHINACOTA","CHITAGA","CONVENCION","CUCUTILLA","DURANIA","ELCARMEN","ELTARRA","ELZULIA","GRAMALOTE","HACARI","HERRAN","LABATECA","LAESPERANZA","LAPLAYA","LOSPATIOS",
                                                        "LOURDES","MUTISCUA","OCAÑA","PAMPLONA","PAMPLONITA","PUERTOSANTANDER","RAGONVALIA","SALAZAR","SANCALIXTO","SANCAYETANO","SANTIAGO","SARDINATA","SILOS","TEORAMA","TIBU","TOLEDO","VILLACARO","VILLADELROSARIO","ARMENIA","BUENAVISTA","CALARCA","CIRCASIA","CORDOBA","FILANDIA","GENOVA","LATEBAIDA","MONTENEGRO","PIJAO","QUIMBAYA","SALENTO","PEREIRA","APIA","BALBOA","BELENDEUMBRIA","DOSQUEBRADAS","GUATICA","LACELIA","LAVIRGINIA","MARSELLA","MISTRATO","PUEBLORICO","QUINCHIA","SANTAROSADECABAL","SANTUARIO","BUCARAMANGA","AGUADA","ALBANIA","ARATOCA","BARBOSA","BARICHARA","BARRANCABERMEJA","BETULIA","BOLIVAR","CABRERA","CALIFORNIA","CAPITANEJO","CARCASI","CEPITA","CERRITO","CHARALA","CHARTA","CHIMA","CHIPATA","CIMITARRA","CONCEPCION","CONFINES","CONTRATACION",
                                                        "COROMORO","CURITI","ELCARMENDECHUCURI","ELGUACAMAYO","ELPEÑON","ELPLAYON","ENCINO","ENCISO","FLORIAN","FLORIDABLANCA","GALAN","GAMBITA","GIRON","GUACA","GUADALUPE","GUAPOTA","GUAVATA","GsEPSA","HATO","JESUSMARIA","JORDAN","LABELLEZA","LANDAZURI","LAPAZ","LEBRIJA","LOSSANTOS","MACARAVITA","MALAGA","MATANZA","MOGOTES","MOLAGAVITA","OCAMONTE","OIBA","ONZAGA","PALMAR","PALMASDELSOCORRO","PARAMO","PIEDECUESTA","PINCHOTE","PUENTENACIONAL","PUERTOPARRA","PUERTOWILCHES","RIONEGRO","SABANADETORRES","SANANDRES","SANBENITO","SANGIL","SANJOAQUIN","SANJOSEDEMIRANDA","SANMIGUEL","SANVICENTEDECHUCURI","SANTABARBARA","SANTAHELENADELOPON","SIMACOTA","SOCORRO","SUAITA","SUCRE","SURATA","TONA","VALLEDESANJOSE","VELEZ","VETAS","VILLANUEVA","ZAPATOCA","SINCELEJO",
                                                        "BUENAVISTA","CAIMITO","COLOSO","COROZAL","COVEÑAS","CHALAN","ELROBLE","GALERAS","GUARANDA","LAUNION","LOSPALMITOS","MAJAGUAL","MORROA","OVEJAS","PALMITO","SAMPUES","SANBENITOABAD","SANJUANDEBETULIA","SANMARCOS","SANONOFRE","SANPEDRO","SANLUISDESINCE","SUCRE","SANTIAGODETOLU","TOLUVIEJO","IBAGUE","ALPUJARRA","ALVARADO","AMBALEMA","ANZOATEGUI","ARMERO","ATACO","CAJAMARCA","CARMENDEAPICALA","CASABIANCA","CHAPARRAL","COELLO","COYAIMA","CUNDAY","DOLORES","ESPINAL","FALAN","FLANDES","FRESNO","GUAMO","HERVEO","HONDA","ICONONZO","LERIDA","LIBANO","MARIQUITA","MELGAR","MURILLO","NATAGAIMA","ORTEGA","PALOCABILDO","PIEDRAS","PLANADAS","PRADO","PURIFICACION","RIOBLANCO","RONCESVALLES","ROVIRA","SALDAÑA","SANANTONIO","SANLUIS","SANTAISABEL","SUAREZ","VALLEDESANJUAN",
                                                        "VENADILLO","VILLAHERMOSA","VILLARRICA","CALI","ALCALA","ANDALUCIA","ANSERMANUEVO","ARGELIA","BOLIVAR","BUENAVENTURA","GUADALAJARADEBUGA","BUGALAGRANDE","CAICEDONIA","CALIMA","CANDELARIA","CARTAGO","DAGUA","ELAGUILA","ELCAIRO","ELCERRITO","ELDOVIO","FLORIDA","GINEBRA","GUACARI","JAMUNDI","LACUMBRE","LAUNION","LAVICTORIA","OBANDO","PALMIRA","PRADERA","RESTREPO","RIOFRIO","ROLDANILLO","SANPEDRO","SEVILLA","TORO","TRUJILLO","TULUA","ULLOA","VERSALLES","VIJES","YOTOCO","YUMBO","ZARZAL","ARAUCA","ARAUQUITA","CRAVONORTE","FORTUL","PUERTORONDON","SARAVENA","TAME","YOPAL","AGUAZUL","CHAMEZA","HATOCOROZAL","LASALINA","MANI","MONTERREY","NUNCHIA","OROCUE","PAZDEARIPORO","PORE","RECETOR","SABANALARGA","SACAMA","SANLUISDEPALENQUE","TAMARA","TAURAMENA","TRINIDAD",
                                                        "VILLANUEVA","MOCOA","COLON","ORITO","PUERTOASIS","PUERTOCAICEDO","PUERTOGUZMAN","LEGUIZAMO","SIBUNDOY","SANFRANCISCO","SANMIGUEL","SANTIAGO","VALLEDELGUAMUEZ","VILLAGARZON","SANANDRES","PROVIDENCIA","LETICIA","ELENCANTO","LACHORRERA","LAPEDRERA","LAVICTORIA","MIRITI-PARANA","PUERTOALEGRIA","PUERTOARICA","PUERTONARIÑO","PUERTOSANTANDER","TARAPACA","INIRIDA","BARRANCOMINAS","MAPIRIPANA","SANFELIPE","PUERTOCOLOMBIA","LAGUADALUPE","CACAHUAL","PANAPANA","MORICHAL","SANJOSEDELGUAVIARE","CALAMAR","ELRETORNO","MIRAFLORES","MITU","CARURU","PACOA","TARAIRA","PAPUNAUA","YAVARATE","PUERTOCARREÑO","LAPRIMAVERA","SANTAROSALIA","CUMARIBO"))

# Borrar la 16 es la especificación del centro poblado.
colnames(defunciones_id)[17] <- "manera_muerte"
defunciones_id$manera_muerte <- factor(defunciones_id$manera_muerte, levels = c(1,2,3), labels = c("natural", "violenta","en_estudio"), ordered = TRUE)
# Borrar la 18 es la el tipo de muerte y todas son fetales
colnames(defunciones_id)[19] <- "area_reside_habitual"
defunciones_id$area_reside_habitual <- factor(defunciones_id$area_reside_habitual, levels = c(1:3),labels =c("cabecera","centro_poblado","rural_disperso"), ordered = TRUE)
colnames(defunciones_id)[20] <- "municipio_residencia"
defunciones_id$municipio_residencia <- factor(defunciones_id$municipio_residencia, 
                                              levels=c(5001,5002,5004,5021,5030,5031,5034,5036,5038,5040,5042,5044,5045,5051,5055,5059,5079,5086,5088,5091,5093,5101,5107,5113,5120,5125,5129,5134,5138,5142,5145,5147,5148,5150,5154,5172,5190,5197,5206,5209,5212,5234,5237,5240,5250,5264,5266,5282,5284,5306,5308,5310,5313,5315,5318,5321,5347,5353,5360,5361,5364,5368,5376,5380,5390,5400,5411,5425,5440,5467,5475,5480,5483,5490,5495,5501,5541,5543,5576,5579,5585,5591,5604,5607,5615,5628,5631,5642,5647,5649,5652,5656,5658,5659,5660,5664,5665,5667,5670,5674,5679,5686,5690,5697,5736,5756,5761,5789,5790,5792,5809,5819,5837,5842,5847,5854,5856,5858,5861,5873,5885,5887,5890,5893,5895,8001,8078,8137,8141,8296,8372,8421,8433,8436,8520,8549,8558,8560,8573,8606,8634,8638,8675,8685,8758,8770,8832,8849
                                                       ,11001,13001,13006,13030,13042,13052,13062,13074,13140,13160,13188,13212,13222,13244,13248,13268,13300,13430,13433,13440,13442,13458,13468,13490,13473,13549,13580,13600,13620,13647,13650,13654,13655,13657,13667,13670,13673,13683,13688,13744,13760,13780,13810,13836,13838,13873,13894,15001,15022,15047,15051,15087,15090,15092,15097,15104,15106,15109,15114,15131,15135,15162,15172,15176,15180,15183,15185,15187,15189,15204,15212,15215,15218,15223,15224,15226,15232,15236,15238,15244,15248,15272,15276,15293,15296,15299,15317,15322,15325,15332,15362,15367,15368,15377,15380,15401,15403,15407,15425,15442,15455,15464,15466,15469,15476,15480,15491,15494,15500,15507,15511,15514,15516,15518,15522,15531,15533,15537,15542,15550,15572,15580,15599,
                                                       15600,15621,15632,15638,15646,15660,15664,15667,15673,15676,15681,15686,15690,15693,15696,15720,15723,15740,15753,15755,15757,15759,15761,15762,15763,15764,15774,15776,15778,15790,15798,15804,15806,15808,15810,15814,15816,15820,15822,15832,15835,15837,15839,15842,15861,15879,15897,17001,17013,17042,17050,17088,17174,17272,17380,17388,17433,17442,17444,17446,17486,17495,17513,17524,17541,17614,17616,17653,17662,17665,17777,17867,17873,17877,18001,18029,18094,18150,18205,18247,18256,18410,18460,18479,18592,18610,18753,18756,18785,18860,19001,19022,19050,19075,19100,19110,19130,19137,19142,19212,19256,19290,19300,19318,19355,19364,19392,19397,19418,19450,19455,19473,19513,19517,19532,19533,19548,19573,19585,19622,19693,19698,19701,
                                                       19743,19760,19780,19785,19807,19809,19821,19824,19845,20001,20011,20013,20032,20045,20060,20175,20178,20228,20238,20250,20295,20310,20383,20400,20443,20517,20550,20570,20614,20621,20710,20750,20770,20787,23001,23068,23079,23090,23162,23168,23182,23189,23300,23350,23417,23419,23464,23466,23500,23555,23570,23574,23580,23586,23660,23670,23672,23675,23678,23686,23807,23855,25001,25019,25035,25040,25053,25086,25095,25099,25120,25123,25126,25148,25151,25154,25168,25175,25178,25181,25183,25200,25214,25224,25245,25258,25260,25269,25279,25281,25286,25288,25290,25293,25295,25297,25299,25307,25312,25317,25320,25322,25324,25326,25328,25335,25339,25368,25372,25377,25386,25394,25398,25402,25407,25426,25430,25436,25438,25473,25483,25486,25488,
                                                       25489,25491,25506,25513,25518,25524,25530,25535,25572,25580,25592,25594,25596,25599,25612,25645,25649,25653,25658,25662,25718,25736,25740,25743,25745,25754,25758,25769,25772,25777,25779,25781,25785,25793,25797,25799,25805,25807,25815,25817,25823,25839,25841,25843,25845,25851,25862,25867,25871,25873,25875,25878,25885,25898,25899,27001,27006,27025,27050,27073,27075,27077,27099,27135,27150,27160,27205,27245,27250,27361,27372,27413,27425,27430,27450,27491,27495,27580,27600,27615,27660,27745,27787,27800,27810,41001,41006,41013,41016,41020,41026,41078,41132,41206,41244,41298,41306,41319,41349,41357,41359,41378,41396,41483,41503,41518,41524,41530,41548,41551,41615,41660,41668,41676,41770,41791,41797,41799,41801,41807,41872,41885,44001,
                                                       44035,44078,44090,44098,44110,44279,44378,44420,44430,44560,44650,44847,44855,44874,47001,47030,47053,47058,47161,47170,47189,47205,47245,47258,47268,47288,47318,47460,47541,47545,47551,47555,47570,47605,47660,47675,47692,47703,47707,47720,47745,47798,47960,47980,50001,50006,50110,50124,50150,50223,50226,50245,50251,50270,50287,50313,50318,50325,50330,50350,50370,50400,50450,50568,50573,50577,50590,50606,50680,50683,50686,50689,50711,52001,52019,52022,52036,52051,52079,52083,52110,52203,52207,52210,52215,52224,52227,52233,52240,52250,52254,52256,52258,52260,52287,52317,52320,52323,52352,52354,52356,52378,52381,52385,52390,52399,52405,52411,52418,52427,52435,52473,52480,52490,52506,52520,52540,52560,52565,52573,52585,52612,52621,
                                                       52678,52683,52685,52687,52693,52694,52696,52699,52720,52786,52788,52835,52838,52885,54001,54003,54051,54099,54109,54125,54128,54172,54174,54206,54223,54239,54245,54250,54261,54313,54344,54347,54377,54385,54398,54405,54418,54480,54498,54518,54520,54553,54599,54660,54670,54673,54680,54720,54743,54800,54810,54820,54871,54874,63001,63111,63130,63190,63212,63272,63302,63401,63470,63548,63594,63690,66001,66045,66075,66088,66170,66318,66383,66400,66440,66456,66572,66594,66682,66687,68001,68013,68020,68051,68077,68079,68081,68092,68101,68121,68132,68147,68152,68160,68162,68167,68169,68176,68179,68190,68207,68209,68211,68217,68229,68235,68245,68250,68255,68264,68266,68271,68276,68296,68298,68307,68318,68320,68322,68324,68327,68344,68368,
                                                       68370,68377,68385,68397,68406,68418,68425,68432,68444,68464,68468,68498,68500,68502,68522,68524,68533,68547,68549,68572,68573,68575,68615,68655,68669,68673,68679,68682,68684,68686,68689,68705,68720,68745,68755,68770,68773,68780,68820,68855,68861,68867,68872,68895,70001,70110,70124,70204,70215,70221,70230,70233,70235,70265,70400,70418,70429,70473,70508,70523,70670,70678,70702,70708,70713,70717,70742,70771,70820,70823,73001,73024,73026,73030,73043,73055,73067,73124,73148,73152,73168,73200,73217,73226,73236,73268,73270,73275,73283,73319,73347,73349,73352,73408,73411,73443,73449,73461,73483,73504,73520,73547,73555,73563,73585,73616,73622,73624,73671,73675,73678,73686,73770,73854,73861,73870,73873,76001,76020,76036,76041,76054,76100,
                                                       76109,76111,76113,76122,76126,76130,76147,76233,76243,76246,76248,76250,76275,76306,76318,76364,76377,76400,76403,76497,76520,76563,76606,76616,76622,76670,76736,76823,76828,76834,76845,76863,76869,76890,76892,76895,81001,81065,81220,81300,81591,81736,81794,85001,85010,85015,85125,85136,85139,85162,85225,85230,85250,85263,85279,85300,85315,85325,85400,85410,85430,85440,86001,86219,86320,86568,86569,86571,86573,86749,86755,86757,86760,86865,86885,88001,88564,91001,91263,91405,91407,91430,91460,91530,91536,91540,91669,91798,94001,94343,94663,94883,94884,94885,94886,94887,94888,95001,95015,95025,95200,97001,97161,97511,97666,97777,97889,99001,99524,99624,99773),
                                              labels = c("MEDELLIN","ABEJORRAL","ABRIAQUI","ALEJANDRIA","AMAGA","AMALFI","ANDES","ANGELOPOLIS","ANGOSTURA","ANORI","SANTAFEDEANTIOQUIA","ANZA","APARTADO","ARBOLETES","ARGELIA","ARMENIA","BARBOSA","BELMIRA","BELLO","BETANIA","BETULIA","CIUDADBOLIVAR","BRICEÑO","BURITICA","CACERES","CAICEDO","CALDAS","CAMPAMENTO","CAÑASGORDAS","CARACOLI","CARAMANTA","CAREPA","ELCARMENDEVIBORAL","CAROLINA","CAUCASIA","CHIGORODO","CISNEROS","COCORNA","CONCEPCION","CONCORDIA","COPACABANA","DABEIBA","DONMATIAS","EBEJICO","ELBAGRE","ENTRERRIOS","ENVIGADO","FREDONIA","FRONTINO","GIRALDO","GIRARDOTA","GOMEZPLATA","GRANADA","GUADALUPE","GUARNE","GUATAPE","HELICONIA","HISPANIA","ITAGUI","ITUANGO","JARDIN","JERICO","LACEJA","LAESTRELLA","LAPINTADA","LAUNION","LIBORINA",
                                                         "MACEO","MARINILLA","MONTEBELLO","MURINDO","MUTATA","NARIÑO","NECOCLI","NECHI","OLAYA","PEÐOL","PEQUE","PUEBLORRICO","PUERTOBERRIO","PUERTONARE","PUERTOTRIUNFO","REMEDIOS","RETIRO","RIONEGRO","SABANALARGA","SABANETA","SALGAR","SANANDRESDECUERQUIA","SANCARLOS","SANFRANCISCO","SANJERONIMO","SANJOSEDELAMONTAÑA","SANJUANDEURABA","SANLUIS","SANPEDRO","SANPEDRODEURABA","SANRAFAEL","SANROQUE","SANVICENTE","SANTABARBARA","SANTAROSADEOSOS","SANTODOMINGO","ELSANTUARIO","SEGOVIA","SONSON","SOPETRAN","TAMESIS","TARAZA","TARSO","TITIRIBI","TOLEDO","TURBO","URAMITA","URRAO","VALDIVIA","VALPARAISO","VEGACHI","VENECIA","VIGIADELFUERTE","YALI","YARUMAL","YOLOMBO","YONDO","ZARAGOZA","BARRANQUILLA","BARANOA","CAMPODELACRUZ","CANDELARIA","GALAPA","JUANDEACOSTA",
                                                         "LURUACO","MALAMBO","MANATI","PALMARDEVARELA","PIOJO","POLONUEVO","PONEDERA","PUERTOCOLOMBIA","REPELON","SABANAGRANDE","SABANALARGA","SANTALUCIA","SANTOTOMAS","SOLEDAD","SUAN","TUBARA","USIACURI","BOGOTA,D.C.","CARTAGENA","ACHI","ALTOSDELROSARIO","ARENAL","ARJONA","ARROYOHONDO","BARRANCODELOBA","CALAMAR","CANTAGALLO","CICUCO","CORDOBA","CLEMENCIA","ELCARMENDEBOLIVAR","ELGUAMO","ELPEÑON","HATILLODELOBA","MAGANGUE","MAHATES","MARGARITA","MARIALABAJA","MONTECRISTO","MOMPOS","NOROSI","MORALES","PINILLOS","REGIDOR","RIOVIEJO","SANCRISTOBAL","SANESTANISLAO","SANFERNANDO","SANJACINTO","SANJACINTODELCAUCA","SANJUANNEPOMUCENO","SANMARTINDELOBA","SANPABLO","SANTACATALINA","SANTAROSA","SANTAROSADELSUR","SIMITI","SOPLAVIENTO","TALAIGUANUEVO","TIQUISIO",
                                                         "TURBACO","TURBANA","VILLANUEVA","ZAMBRANO","TUNJA","ALMEIDA","AQUITANIA","ARCABUCO","BELEN","BERBEO","BETEITIVA","BOAVITA","BOYACA","BRICEÑO","BUENAVISTA","BUSBANZA","CALDAS","CAMPOHERMOSO","CERINZA","CHINAVITA","CHIQUINQUIRA","CHISCAS","CHITA","CHITARAQUE","CHIVATA","CIENEGA","COMBITA","COPER","CORRALES","COVARACHIA","CUBARA","CUCAITA","CUITIVA","CHIQUIZA","CHIVOR","DUITAMA","ELCOCUY","ELESPINO","FIRAVITOBA","FLORESTA","GACHANTIVA","GAMEZA","GARAGOA","GUACAMAYAS","GUATEQUE","GUAYATA","GsICAN","IZA","JENESANO","JERICO","LABRANZAGRANDE","LACAPILLA","LAVICTORIA","LAUVITA","VILLADELEYVA","MACANAL","MARIPI","MIRAFLORES","MONGUA","MONGUI","MONIQUIRA","MOTAVITA","MUZO","NOBSA","NUEVOCOLON","OICATA","OTANCHE","PACHAVITA","PAEZ","PAIPA","PAJARITO",
                                                         "PANQUEBA","PAUNA","PAYA","PAZDERIO","PESCA","PISBA","PUERTOBOYACA","QUIPAMA","RAMIRIQUI","RAQUIRA","RONDON","SABOYA","SACHICA","SAMACA","SANEDUARDO","SANJOSEDEPARE","SANLUISDEGACENO","SANMATEO","SANMIGUELDESEMA","SANPABLODEBORBUR","SANTANA","SANTAMARIA","SANTAROSADEVITERBO","SANTASOFIA","SATIVANORTE","SATIVASUR","SIACHOQUE","SOATA","SOCOTA","SOCHA","SOGAMOSO","SOMONDOCO","SORA","SOTAQUIRA","SORACA","SUSACON","SUTAMARCHAN","SUTATENZA","TASCO","TENZA","TIBANA","TIBASOSA","TINJACA","TIPACOQUE","TOCA","TOGsI","TOPAGA","TOTA","TUNUNGUA","TURMEQUE","TUTA","TUTAZA","UMBITA","VENTAQUEMADA","VIRACACHA","ZETAQUIRA","MANIZALES","AGUADAS","ANSERMA","ARANZAZU","BELALCAZAR","CHINCHINA","FILADELFIA","LADORADA","LAMERCED","MANZANARES","MARMATO","MARQUETALIA",
                                                         "MARULANDA","NEIRA","NORCASIA","PACORA","PALESTINA","PENSILVANIA","RIOSUCIO","RISARALDA","SALAMINA","SAMANA","SANJOSE","SUPIA","VICTORIA","VILLAMARIA","VITERBO","FLORENCIA","ALBANIA","BELENDELOSANDAQUIES","CARTAGENADELCHAIRA","CURILLO","ELDONCELLO","ELPAUJIL","LAMONTAÑITA","MILAN","MORELIA","PUERTORICO","SANJOSEDELFRAGUA","SANVICENTEDELCAGUAN","SOLANO","SOLITA","VALPARAISO","POPAYAN","ALMAGUER","ARGELIA","BALBOA","BOLIVAR","BUENOSAIRES","CAJIBIO","CALDONO","CALOTO","CORINTO","ELTAMBO","FLORENCIA","GUACHENE","GUAPI","INZA","JAMBALO","LASIERRA","LAVEGA","LOPEZ","MERCADERES","MIRANDA","MORALES","PADILLA","PAEZ","PATIA","PIAMONTE","PIENDAMO","PUERTOTEJADA","PURACE","ROSAS","SANSEBASTIAN","SANTANDERDEQUILICHAO","SANTAROSA","SILVIA","SOTARA","SUAREZ",
                                                         "SUCRE","TIMBIO","TIMBIQUI","TORIBIO","TOTORO","VILLARICA","VALLEDUPAR","AGUACHICA","AGUSTINCODAZZI","ASTREA","BECERRIL","BOSCONIA","CHIMICHAGUA","CHIRIGUANA","CURUMANI","ELCOPEY","ELPASO","GAMARRA","GONZALEZ","LAGLORIA","LAJAGUADEIBIRICO","MANAURE","PAILITAS","PELAYA","PUEBLOBELLO","RIODEORO","LAPAZ","SANALBERTO","SANDIEGO","SANMARTIN","TAMALAMEQUE","MONTERIA","AYAPEL","BUENAVISTA","CANALETE","CERETE","CHIMA","CHINU","CIENAGADEORO","COTORRA","LAAPARTADA","LORICA","LOSCORDOBAS","MOMIL","MONTELIBANO","MOÑITOS","PLANETARICA","PUEBLONUEVO","PUERTOESCONDIDO","PUERTOLIBERTADOR","PURISIMA","SAHAGUN","SANANDRESSOTAVENTO","SANANTERO","SANBERNARDODELVIENTO","SANCARLOS","SANPELAYO","TIERRALTA","VALENCIA","AGUADEDIOS","ALBAN","ANAPOIMA","ANOLAIMA","ARBELAEZ",
                                                         "BELTRAN","BITUIMA","BOJACA","CABRERA","CACHIPAY","CAJICA","CAPARRAPI","CAQUEZA","CARMENDECARUPA","CHAGUANI","CHIA","CHIPAQUE","CHOACHI","CHOCONTA","COGUA","COTA","CUCUNUBA","ELCOLEGIO","ELPEÑON","ELROSAL","FACATATIVA","FOMEQUE","FOSCA","FUNZA","FUQUENE","FUSAGASUGA","GACHALA","GACHANCIPA","GACHETA","GAMA","GIRARDOT","GRANADA","GUACHETA","GUADUAS","GUASCA","GUATAQUI","GUATAVITA","GUAYABALDESIQUIMA","GUAYABETAL","GUTIERREZ","JERUSALEN","JUNIN","LACALERA","LAMESA","LAPALMA","LAPEÑA","LAVEGA","LENGUAZAQUE","MACHETA","MADRID","MANTA","MEDINA","MOSQUERA","NARIÑO","NEMOCON","NILO","NIMAIMA","NOCAIMA","VENECIA","PACHO","PAIME","PANDI","PARATEBUENO","PASCA","PUERTOSALGAR","PULI","QUEBRADANEGRA","QUETAME","QUIPILE","APULO","RICAURTE","SANANTONIODELTEQUENDAMA",
                                                         "SANBERNARDO","SANCAYETANO","SANFRANCISCO","SANJUANDERIOSECO","SASAIMA","SESQUILE","SIBATE","SILVANIA","SIMIJACA","SOACHA","SOPO","SUBACHOQUE","SUESCA","SUPATA","SUSA","SUTATAUSA","TABIO","TAUSA","TENA","TENJO","TIBACUY","TIBIRITA","TOCAIMA","TOCANCIPA","TOPAIPI","UBALA","UBAQUE","VILLADESANDIEGODEUBATE","UNE","UTICA","VERGARA","VIANI","VILLAGOMEZ","VILLAPINZON","VILLETA","VIOTA","YACOPI","ZIPACON","ZIPAQUIRA","QUIBDO","ACANDI","ALTOBAUDO","ATRATO","BAGADO","BAHIASOLANO","BAJOBAUDO","BOJAYA","ELCANTONDELSANPABLO","CARMENDELDARIEN","CERTEGUI","CONDOTO","ELCARMENDEATRATO","ELLITORALDELSANJUAN","ISTMINA","JURADO","LLORO","MEDIOATRATO","MEDIOBAUDO","MEDIOSANJUAN","NOVITA","NUQUI","RIOIRO","RIOQUITO","RIOSUCIO","SANJOSEDELPALMAR","SIPI","TADO","UNGUIA",
                                                         "UNIONPANAMERICANA","NEIVA","ACEVEDO","AGRADO","AIPE","ALGECIRAS","ALTAMIRA","BARAYA","CAMPOALEGRE","COLOMBIA","ELIAS","GARZON","GIGANTE","GUADALUPE","HOBO","IQUIRA","ISNOS","LAARGENTINA","LAPLATA","NATAGA","OPORAPA","PAICOL","PALERMO","PALESTINA","PITAL","PITALITO","RIVERA","SALADOBLANCO","SANAGUSTIN","SANTAMARIA","SUAZA","TARQUI","TESALIA","TELLO","TERUEL","TIMANA","VILLAVIEJA","YAGUARA","RIOHACHA","ALBANIA","BARRANCAS","DIBULLA","DISTRACCION","ELMOLINO","FONSECA","HATONUEVO","LAJAGUADELPILAR","MAICAO","MANAURE","SANJUANDELCESAR","URIBIA","URUMITA","VILLANUEVA","SANTAMARTA","ALGARROBO","ARACATACA","ARIGUANI","CERROSANANTONIO","CHIBOLO","CIENAGA","CONCORDIA","ELBANCO","ELPIÑON","ELRETEN","FUNDACION","GUAMAL","NUEVAGRANADA","PEDRAZA","PIJIÑODELCARMEN",
                                                         "PIVIJAY","PLATO","PUEBLOVIEJO","REMOLINO","SABANASDESANANGEL","SALAMINA","SANSEBASTIANDEBUENAVISTA","SANZENON","SANTAANA","SANTABARBARADEPINTO","SITIONUEVO","TENERIFE","ZAPAYAN","ZONABANANERA","VILLAVICENCIO","ACACIAS","BARRANCADEUPIA","CABUYARO","CASTILLALANUEVA","CUBARRAL","CUMARAL","ELCALVARIO","ELCASTILLO","ELDORADO","FUENTEDEORO","GRANADA","GUAMAL","MAPIRIPAN","MESETAS","LAMACARENA","URIBE","LEJANIAS","PUERTOCONCORDIA","PUERTOGAITAN","PUERTOLOPEZ","PUERTOLLERAS","PUERTORICO","RESTREPO","SANCARLOSDEGUAROA","SANJUANDEARAMA","SANJUANITO","SANMARTIN","VISTAHERMOSA","PASTO","ALBAN","ALDANA","ANCUYA","ARBOLEDA","BARBACOAS","BELEN","BUESACO","COLON","CONSACA","CONTADERO","CORDOBA","CUASPUD","CUMBAL","CUMBITARA","CHACHAGsI","ELCHARCO","ELPEÑOL","ELROSARIO",
                                                         "ELTABLONDEGOMEZ","ELTAMBO","FUNES","GUACHUCAL","GUAITARILLA","GUALMATAN","ILES","IMUES","IPIALES","LACRUZ","LAFLORIDA","LALLANADA","LATOLA","LAUNION","LEIVA","LINARES","LOSANDES","MAGsI","MALLAMA","MOSQUERA","NARIÑO","OLAYAHERRERA","OSPINA","FRANCISCOPIZARRO","POLICARPA","POTOSI","PROVIDENCIA","PUERRES","PUPIALES","RICAURTE","ROBERTOPAYAN","SAMANIEGO","SANDONA","SANBERNARDO","SANLORENZO","SANPABLO","SANPEDRODECARTAGO","SANTABARBARA","SANTACRUZ","SAPUYES","TAMINANGO","TANGUA","SANANDRESDETUMACO","TUQUERRES","YACUANQUER","CUCUTA","ABREGO","ARBOLEDAS","BOCHALEMA","BUCARASICA","CACOTA","CACHIRA","CHINACOTA","CHITAGA","CONVENCION","CUCUTILLA","DURANIA","ELCARMEN","ELTARRA","ELZULIA","GRAMALOTE","HACARI","HERRAN","LABATECA","LAESPERANZA","LAPLAYA","LOSPATIOS",
                                                         "LOURDES","MUTISCUA","OCAÑA","PAMPLONA","PAMPLONITA","PUERTOSANTANDER","RAGONVALIA","SALAZAR","SANCALIXTO","SANCAYETANO","SANTIAGO","SARDINATA","SILOS","TEORAMA","TIBU","TOLEDO","VILLACARO","VILLADELROSARIO","ARMENIA","BUENAVISTA","CALARCA","CIRCASIA","CORDOBA","FILANDIA","GENOVA","LATEBAIDA","MONTENEGRO","PIJAO","QUIMBAYA","SALENTO","PEREIRA","APIA","BALBOA","BELENDEUMBRIA","DOSQUEBRADAS","GUATICA","LACELIA","LAVIRGINIA","MARSELLA","MISTRATO","PUEBLORICO","QUINCHIA","SANTAROSADECABAL","SANTUARIO","BUCARAMANGA","AGUADA","ALBANIA","ARATOCA","BARBOSA","BARICHARA","BARRANCABERMEJA","BETULIA","BOLIVAR","CABRERA","CALIFORNIA","CAPITANEJO","CARCASI","CEPITA","CERRITO","CHARALA","CHARTA","CHIMA","CHIPATA","CIMITARRA","CONCEPCION","CONFINES","CONTRATACION",
                                                         "COROMORO","CURITI","ELCARMENDECHUCURI","ELGUACAMAYO","ELPEÑON","ELPLAYON","ENCINO","ENCISO","FLORIAN","FLORIDABLANCA","GALAN","GAMBITA","GIRON","GUACA","GUADALUPE","GUAPOTA","GUAVATA","GsEPSA","HATO","JESUSMARIA","JORDAN","LABELLEZA","LANDAZURI","LAPAZ","LEBRIJA","LOSSANTOS","MACARAVITA","MALAGA","MATANZA","MOGOTES","MOLAGAVITA","OCAMONTE","OIBA","ONZAGA","PALMAR","PALMASDELSOCORRO","PARAMO","PIEDECUESTA","PINCHOTE","PUENTENACIONAL","PUERTOPARRA","PUERTOWILCHES","RIONEGRO","SABANADETORRES","SANANDRES","SANBENITO","SANGIL","SANJOAQUIN","SANJOSEDEMIRANDA","SANMIGUEL","SANVICENTEDECHUCURI","SANTABARBARA","SANTAHELENADELOPON","SIMACOTA","SOCORRO","SUAITA","SUCRE","SURATA","TONA","VALLEDESANJOSE","VELEZ","VETAS","VILLANUEVA","ZAPATOCA","SINCELEJO",
                                                         "BUENAVISTA","CAIMITO","COLOSO","COROZAL","COVEÑAS","CHALAN","ELROBLE","GALERAS","GUARANDA","LAUNION","LOSPALMITOS","MAJAGUAL","MORROA","OVEJAS","PALMITO","SAMPUES","SANBENITOABAD","SANJUANDEBETULIA","SANMARCOS","SANONOFRE","SANPEDRO","SANLUISDESINCE","SUCRE","SANTIAGODETOLU","TOLUVIEJO","IBAGUE","ALPUJARRA","ALVARADO","AMBALEMA","ANZOATEGUI","ARMERO","ATACO","CAJAMARCA","CARMENDEAPICALA","CASABIANCA","CHAPARRAL","COELLO","COYAIMA","CUNDAY","DOLORES","ESPINAL","FALAN","FLANDES","FRESNO","GUAMO","HERVEO","HONDA","ICONONZO","LERIDA","LIBANO","MARIQUITA","MELGAR","MURILLO","NATAGAIMA","ORTEGA","PALOCABILDO","PIEDRAS","PLANADAS","PRADO","PURIFICACION","RIOBLANCO","RONCESVALLES","ROVIRA","SALDAÑA","SANANTONIO","SANLUIS","SANTAISABEL","SUAREZ","VALLEDESANJUAN",
                                                         "VENADILLO","VILLAHERMOSA","VILLARRICA","CALI","ALCALA","ANDALUCIA","ANSERMANUEVO","ARGELIA","BOLIVAR","BUENAVENTURA","GUADALAJARADEBUGA","BUGALAGRANDE","CAICEDONIA","CALIMA","CANDELARIA","CARTAGO","DAGUA","ELAGUILA","ELCAIRO","ELCERRITO","ELDOVIO","FLORIDA","GINEBRA","GUACARI","JAMUNDI","LACUMBRE","LAUNION","LAVICTORIA","OBANDO","PALMIRA","PRADERA","RESTREPO","RIOFRIO","ROLDANILLO","SANPEDRO","SEVILLA","TORO","TRUJILLO","TULUA","ULLOA","VERSALLES","VIJES","YOTOCO","YUMBO","ZARZAL","ARAUCA","ARAUQUITA","CRAVONORTE","FORTUL","PUERTORONDON","SARAVENA","TAME","YOPAL","AGUAZUL","CHAMEZA","HATOCOROZAL","LASALINA","MANI","MONTERREY","NUNCHIA","OROCUE","PAZDEARIPORO","PORE","RECETOR","SABANALARGA","SACAMA","SANLUISDEPALENQUE","TAMARA","TAURAMENA","TRINIDAD",
                                                         "VILLANUEVA","MOCOA","COLON","ORITO","PUERTOASIS","PUERTOCAICEDO","PUERTOGUZMAN","LEGUIZAMO","SIBUNDOY","SANFRANCISCO","SANMIGUEL","SANTIAGO","VALLEDELGUAMUEZ","VILLAGARZON","SANANDRES","PROVIDENCIA","LETICIA","ELENCANTO","LACHORRERA","LAPEDRERA","LAVICTORIA","MIRITI-PARANA","PUERTOALEGRIA","PUERTOARICA","PUERTONARIÑO","PUERTOSANTANDER","TARAPACA","INIRIDA","BARRANCOMINAS","MAPIRIPANA","SANFELIPE","PUERTOCOLOMBIA","LAGUADALUPE","CACAHUAL","PANAPANA","MORICHAL","SANJOSEDELGUAVIARE","CALAMAR","ELRETORNO","MIRAFLORES","MITU","CARURU","PACOA","TARAIRA","PAPUNAUA","YAVARATE","PUERTOCARREÑO","LAPRIMAVERA","SANTAROSALIA","CUMARIBO"))

# Eliminar 21 es el centro poblado especificado
colnames(defunciones_id)[22] <- "estado_conyugal"
defunciones_id$estado_conyugal <- factor(defunciones_id$estado_conyugal, levels = c(1:7),labels =c("dos años convivencia","menos de dos años convivencia","separada","viuda","soltera","casada","desconocido"), ordered = TRUE) 
# Eliminar 23, el id del certificador
colnames(defunciones_id)[24] <- "educ_madre"
defunciones_id$educ_madre <- factor(defunciones_id$educ_madre, levels = c(1:14),labels =c("Preescolar","Básica primaria","Básica secundaria", "Media académica o clásica","Media técnica","Normalista","Técnica profesional","Tecnológica", "Profesional","Especialización","Maestría","Doctorado","Ninguno","desconocido"), ordered = TRUE) 
colnames(defunciones_id)[25] <- "pertenencia_etnica"
defunciones_id$pertenencia_etnica <- factor(defunciones_id$pertenencia_etnica, levels = c(1:6),labels =c("indigena","rom","raizal", "palenquero","negro_afro_mulato","ninguno"), ordered = TRUE) 
# Borrar 26, pueblo indigena y todo NA
# Borrar 27, estado conyugal de fetos...
# Borrar 28, código país...
# borrar 29, edad fallecido, solo NA
# borrar 30, tipo muerte violenta solo 60 datos
# borrar 31, ultimo año aprobado feto...
colnames(defunciones_id)[32] <- "sexo"
defunciones_id$sexo <- factor(defunciones_id$sexo, levels = c(1,2,3),labels =c("masculino","femenino","indeterminado"), ordered = TRUE)
colnames(defunciones_id)[33] <- "eps"
# borrar 34, "estado certificado" no interesa
# borrar 35, codigo institucional de salud
colnames(defunciones_id)[36] <- "defuncion_certificada_por"
defunciones_id$defuncion_certificada_por <- factor(defunciones_id$defuncion_certificada_por, levels = c(1,2,3,4,5),labels =c("Médico tratante","Médico no tratante","Médico legista","Personal de salud autorizado","Funcionario de registro civil"), ordered = TRUE)
colnames(defunciones_id)[37] <- "fecha_nac_def"
# Borrar 38, en todas es el valor 1900-01-01
# Borrar 39, en todas es -1
# borrar 40, es último curso aprobado fallecido....
# borrar 41,especificación de "otro" lugar defunción y solo NA
# borrar 42, solo NA
# borrar 43, solo NA
colnames(defunciones_id)[44] <- "tiempo_gestacion"
colnames(defunciones_id)[45] <- "peso_nacer"
colnames(defunciones_id)[46] <- "edad_materna"
colnames(defunciones_id)[47] <- "numero_nacidos_vivos"
colnames(defunciones_id)[48] <- "numero_mortinatos"
# borrar si contamos con educ_madre, es el último curso
# borrar 50, es la descripción de como ocurrió la muerte, el relato. 
# borrar 51, es la dirección del domicilio si muerte violenta
# borrar 52, muerte sin certificación médica
colnames(defunciones_id)[53] <- "fecha_expedicion"#considerar eliminar
# borrar 54, fecha de confirmación
# borrar 55, fecha de expedición pero ya tenemos residencia y lugar de defunción
# borrar 56, es la fecha de última modificación
# borrar 57, es la especificación a "otro sitio de defunción"
# borrar 58, es anulada o no anulada, muy pocos anulados, tocaría revisar pertinencia
colnames(defunciones_id)[59] <- "regimen_salud"
defunciones_id$regimen_salud[defunciones_id$regimen_salud==" "] <- NA#revisar
defunciones_id$regimen_salud <- factor(defunciones_id$regimen_salud, levels = c(1:5),labels =c("contributivo","subsidiado","excepcion","especial","ninguno"), ordered = TRUE)
# BOrrar 60, es la clase administradora 
# borrar 61, es muerte por ocupación
# borrar 62, es accidente de trabajo
# borrar 63, es el código de la ocupación
# borrar 64, es si la hora era desconocida
# borrar 65, es la fecha de registro
# borrar 66, es si hubo necropsia
# borrar 67, es si hubo historia clinica
# borrar 68, es si hubo laboratorios
# borrar 69, es si hubo interrogatorio a los familiares
colnames(defunciones_id)[70] <- "diagnostico_a"
# borrar 71, es timepo de diagnostico a mal medido
# borrar 72, unidad metrica para 71
# borrar 73, es el codigo cie 10 para a pero solo son NA
colnames(defunciones_id)[74] <- "diagnostico_b"
# borrar 75, es timepo de diagnostico b mal medido
# borrar 76, unidad metrica para 75
# borrar 77, es el codigo cie 10 para a pero solo son NA
# se borran de la 78 a la 91, pues la mayoría son solo datos faltantes o variables que no son útiles
colnames(defunciones_id)[92] <- "año_nacimiento_o_defuncion"
colnames(defunciones_id)[93] <- "edad_gestacional_calculada"
colnames(defunciones_id)[94] <- "fecha_probable_concepcion"
colnames(defunciones_id)[95] <- "año_concepcion"

defunciones_para_rbind<- defunciones_id[c(-1,-5:-7,-11,-13,-16,-18,-21,-23,-26:-31,-34,-35,-38:-43,-50:-52,-54:-58,-60:-69,-71:-73,-75:-91)]


# borrar todo menos la base de dfeunciones para hacer rbind ###########

rm(list=setdiff(ls(), "defunciones_para_rbind"))


# Cargo las dos bases de datos de los nacimientos
naci_1 <- read_dta("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/Nacimientos2011_2016.dta")
naci_2 <- read_dta("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/Nacimientos2017_2019.dta")


setorder(naci_1,personaid)
# Esta es la base que debo usar
naci <- rbind(naci_1,naci_2)


# Retiro tres observaciones cuyos datos están mal reportados

naci<-naci[naci$hijnacviv != "1900-01-01 00:00:00" & naci$hijnacviv !="2012-12-31 00:00:00" & naci$hijnacviv != "2016-07-05 00:00:00",]

# creo una variable con el año con los primeros 4 caracteres de la fecha de nacimiento
naci$año_nacimiento <- substring(naci$fechornac,1,4)
# La vuelvo numérica
naci$año_nacimiento <- as.numeric(naci$año_nacimiento)
# Y cuento las observaciones que corresponde a todos los certificados de nacimientos entre el 2013 y el 2018
nrow(naci[naci$año_nacimiento >= 2013 & naci$año_nacimiento <=2018,])

# Hay 3 661 022 observaciones de nacidos entre el 2013 y el 2018 al igual que en el do del doctor Giancarlo

# genero la fecha de concepción para los nacimientos

# Tiempo de gestación en semanas
naci$edadg <- naci$tiemgestac
# Las que cuentan con el tiempo de gestación:
naci$edadg[naci$edadg == -1] <- NA
# Fecha probable de concepción 
naci$fecha_concepcion <- as.Date(naci$fechornac) - (naci$edadg*7) # Son los días en una semana, porque a la variable FECHORDEF es más fácil restarle el tiempo en días


# Al igual que en el do del doctor Giancarlo quitó los que fueron concebidos antes del 2011
naci$año <- substring(naci$fecha_concepcion,1,4)
naci$año <- as.numeric(naci$año)
cohorte_nacimientos_dg <- subset(naci,naci$año > 2010 & naci$año != 2010 |is.na(naci$año) == TRUE)
# 4 558 804 observaciones
# igual que el do del dr Giancarlo



# CREAción BASE DE MUJERES EMBARAZADAS ########

naci$nacido_vivo <- "si"

prueba_c <- naci


colnames(prueba_c)[1] <- "madre_id"
colnames(prueba_c)[2] <- "id_nacido_vivo"
colnames(prueba_c)[3] <- "educ_madre"
prueba_c$educ_madre <- factor(prueba_c$educ_madre, levels = c(1:14),labels =c("Preescolar","Básica primaria","Básica secundaria", "Media académica o clásica","Media técnica","Normalista","Técnica profesional","Tecnológica", "Profesional","Especialización","Maestría","Doctorado","Ninguno","desconocido"), ordered = TRUE) 
colnames(prueba_c)[4] <- "multiplicidad"
prueba_c$multiplicidad <- factor(prueba_c$multiplicidad, levels = c(1,2,3,4), labels = c("simple", "doble", "triple", "cuadruple_o_mas"), ordered = TRUE)
colnames(prueba_c)[5] <- "eps"
colnames(prueba_c)[6] <- "inspeccion_corregimiento_caserio"
colnames(prueba_c)[7] <- "tipo_parto"
prueba_c$tipo_parto <- factor(prueba_c$tipo_parto, levels = c(1,2,3,4), labels = c("espontaneo", "cesarea", "instrumentado", "desconocido"), ordered = TRUE)
colnames(prueba_c)[8] <- "municipio_residencia"
prueba_c$municipio_residencia <- factor(prueba_c$municipio_residencia, 
                                        levels=c(5001,5002,5004,5021,5030,5031,5034,5036,5038,5040,5042,5044,5045,5051,5055,5059,5079,5086,5088,5091,5093,5101,5107,5113,5120,5125,5129,5134,5138,5142,5145,5147,5148,5150,5154,5172,5190,5197,5206,5209,5212,5234,5237,5240,5250,5264,5266,5282,5284,5306,5308,5310,5313,5315,5318,5321,5347,5353,5360,5361,5364,5368,5376,5380,5390,5400,5411,5425,5440,5467,5475,5480,5483,5490,5495,5501,5541,5543,5576,5579,5585,5591,5604,5607,5615,5628,5631,5642,5647,5649,5652,5656,5658,5659,5660,5664,5665,5667,5670,5674,5679,5686,5690,5697,5736,5756,5761,5789,5790,5792,5809,5819,5837,5842,5847,5854,5856,5858,5861,5873,5885,5887,5890,5893,5895,8001,8078,8137,8141,8296,8372,8421,8433,8436,8520,8549,8558,8560,8573,8606,8634,8638,8675,8685,8758,8770,8832,8849
                                                 ,11001,13001,13006,13030,13042,13052,13062,13074,13140,13160,13188,13212,13222,13244,13248,13268,13300,13430,13433,13440,13442,13458,13468,13490,13473,13549,13580,13600,13620,13647,13650,13654,13655,13657,13667,13670,13673,13683,13688,13744,13760,13780,13810,13836,13838,13873,13894,15001,15022,15047,15051,15087,15090,15092,15097,15104,15106,15109,15114,15131,15135,15162,15172,15176,15180,15183,15185,15187,15189,15204,15212,15215,15218,15223,15224,15226,15232,15236,15238,15244,15248,15272,15276,15293,15296,15299,15317,15322,15325,15332,15362,15367,15368,15377,15380,15401,15403,15407,15425,15442,15455,15464,15466,15469,15476,15480,15491,15494,15500,15507,15511,15514,15516,15518,15522,15531,15533,15537,15542,15550,15572,15580,15599,
                                                 15600,15621,15632,15638,15646,15660,15664,15667,15673,15676,15681,15686,15690,15693,15696,15720,15723,15740,15753,15755,15757,15759,15761,15762,15763,15764,15774,15776,15778,15790,15798,15804,15806,15808,15810,15814,15816,15820,15822,15832,15835,15837,15839,15842,15861,15879,15897,17001,17013,17042,17050,17088,17174,17272,17380,17388,17433,17442,17444,17446,17486,17495,17513,17524,17541,17614,17616,17653,17662,17665,17777,17867,17873,17877,18001,18029,18094,18150,18205,18247,18256,18410,18460,18479,18592,18610,18753,18756,18785,18860,19001,19022,19050,19075,19100,19110,19130,19137,19142,19212,19256,19290,19300,19318,19355,19364,19392,19397,19418,19450,19455,19473,19513,19517,19532,19533,19548,19573,19585,19622,19693,19698,19701,
                                                 19743,19760,19780,19785,19807,19809,19821,19824,19845,20001,20011,20013,20032,20045,20060,20175,20178,20228,20238,20250,20295,20310,20383,20400,20443,20517,20550,20570,20614,20621,20710,20750,20770,20787,23001,23068,23079,23090,23162,23168,23182,23189,23300,23350,23417,23419,23464,23466,23500,23555,23570,23574,23580,23586,23660,23670,23672,23675,23678,23686,23807,23855,25001,25019,25035,25040,25053,25086,25095,25099,25120,25123,25126,25148,25151,25154,25168,25175,25178,25181,25183,25200,25214,25224,25245,25258,25260,25269,25279,25281,25286,25288,25290,25293,25295,25297,25299,25307,25312,25317,25320,25322,25324,25326,25328,25335,25339,25368,25372,25377,25386,25394,25398,25402,25407,25426,25430,25436,25438,25473,25483,25486,25488,
                                                 25489,25491,25506,25513,25518,25524,25530,25535,25572,25580,25592,25594,25596,25599,25612,25645,25649,25653,25658,25662,25718,25736,25740,25743,25745,25754,25758,25769,25772,25777,25779,25781,25785,25793,25797,25799,25805,25807,25815,25817,25823,25839,25841,25843,25845,25851,25862,25867,25871,25873,25875,25878,25885,25898,25899,27001,27006,27025,27050,27073,27075,27077,27099,27135,27150,27160,27205,27245,27250,27361,27372,27413,27425,27430,27450,27491,27495,27580,27600,27615,27660,27745,27787,27800,27810,41001,41006,41013,41016,41020,41026,41078,41132,41206,41244,41298,41306,41319,41349,41357,41359,41378,41396,41483,41503,41518,41524,41530,41548,41551,41615,41660,41668,41676,41770,41791,41797,41799,41801,41807,41872,41885,44001,
                                                 44035,44078,44090,44098,44110,44279,44378,44420,44430,44560,44650,44847,44855,44874,47001,47030,47053,47058,47161,47170,47189,47205,47245,47258,47268,47288,47318,47460,47541,47545,47551,47555,47570,47605,47660,47675,47692,47703,47707,47720,47745,47798,47960,47980,50001,50006,50110,50124,50150,50223,50226,50245,50251,50270,50287,50313,50318,50325,50330,50350,50370,50400,50450,50568,50573,50577,50590,50606,50680,50683,50686,50689,50711,52001,52019,52022,52036,52051,52079,52083,52110,52203,52207,52210,52215,52224,52227,52233,52240,52250,52254,52256,52258,52260,52287,52317,52320,52323,52352,52354,52356,52378,52381,52385,52390,52399,52405,52411,52418,52427,52435,52473,52480,52490,52506,52520,52540,52560,52565,52573,52585,52612,52621,
                                                 52678,52683,52685,52687,52693,52694,52696,52699,52720,52786,52788,52835,52838,52885,54001,54003,54051,54099,54109,54125,54128,54172,54174,54206,54223,54239,54245,54250,54261,54313,54344,54347,54377,54385,54398,54405,54418,54480,54498,54518,54520,54553,54599,54660,54670,54673,54680,54720,54743,54800,54810,54820,54871,54874,63001,63111,63130,63190,63212,63272,63302,63401,63470,63548,63594,63690,66001,66045,66075,66088,66170,66318,66383,66400,66440,66456,66572,66594,66682,66687,68001,68013,68020,68051,68077,68079,68081,68092,68101,68121,68132,68147,68152,68160,68162,68167,68169,68176,68179,68190,68207,68209,68211,68217,68229,68235,68245,68250,68255,68264,68266,68271,68276,68296,68298,68307,68318,68320,68322,68324,68327,68344,68368,
                                                 68370,68377,68385,68397,68406,68418,68425,68432,68444,68464,68468,68498,68500,68502,68522,68524,68533,68547,68549,68572,68573,68575,68615,68655,68669,68673,68679,68682,68684,68686,68689,68705,68720,68745,68755,68770,68773,68780,68820,68855,68861,68867,68872,68895,70001,70110,70124,70204,70215,70221,70230,70233,70235,70265,70400,70418,70429,70473,70508,70523,70670,70678,70702,70708,70713,70717,70742,70771,70820,70823,73001,73024,73026,73030,73043,73055,73067,73124,73148,73152,73168,73200,73217,73226,73236,73268,73270,73275,73283,73319,73347,73349,73352,73408,73411,73443,73449,73461,73483,73504,73520,73547,73555,73563,73585,73616,73622,73624,73671,73675,73678,73686,73770,73854,73861,73870,73873,76001,76020,76036,76041,76054,76100,
                                                 76109,76111,76113,76122,76126,76130,76147,76233,76243,76246,76248,76250,76275,76306,76318,76364,76377,76400,76403,76497,76520,76563,76606,76616,76622,76670,76736,76823,76828,76834,76845,76863,76869,76890,76892,76895,81001,81065,81220,81300,81591,81736,81794,85001,85010,85015,85125,85136,85139,85162,85225,85230,85250,85263,85279,85300,85315,85325,85400,85410,85430,85440,86001,86219,86320,86568,86569,86571,86573,86749,86755,86757,86760,86865,86885,88001,88564,91001,91263,91405,91407,91430,91460,91530,91536,91540,91669,91798,94001,94343,94663,94883,94884,94885,94886,94887,94888,95001,95015,95025,95200,97001,97161,97511,97666,97777,97889,99001,99524,99624,99773),
                                        labels = c("MEDELLIN","ABEJORRAL","ABRIAQUI","ALEJANDRIA","AMAGA","AMALFI","ANDES","ANGELOPOLIS","ANGOSTURA","ANORI","SANTAFEDEANTIOQUIA","ANZA","APARTADO","ARBOLETES","ARGELIA","ARMENIA","BARBOSA","BELMIRA","BELLO","BETANIA","BETULIA","CIUDADBOLIVAR","BRICEÑO","BURITICA","CACERES","CAICEDO","CALDAS","CAMPAMENTO","CAÑASGORDAS","CARACOLI","CARAMANTA","CAREPA","ELCARMENDEVIBORAL","CAROLINA","CAUCASIA","CHIGORODO","CISNEROS","COCORNA","CONCEPCION","CONCORDIA","COPACABANA","DABEIBA","DONMATIAS","EBEJICO","ELBAGRE","ENTRERRIOS","ENVIGADO","FREDONIA","FRONTINO","GIRALDO","GIRARDOTA","GOMEZPLATA","GRANADA","GUADALUPE","GUARNE","GUATAPE","HELICONIA","HISPANIA","ITAGUI","ITUANGO","JARDIN","JERICO","LACEJA","LAESTRELLA","LAPINTADA","LAUNION","LIBORINA",
                                                   "MACEO","MARINILLA","MONTEBELLO","MURINDO","MUTATA","NARIÑO","NECOCLI","NECHI","OLAYA","PEÐOL","PEQUE","PUEBLORRICO","PUERTOBERRIO","PUERTONARE","PUERTOTRIUNFO","REMEDIOS","RETIRO","RIONEGRO","SABANALARGA","SABANETA","SALGAR","SANANDRESDECUERQUIA","SANCARLOS","SANFRANCISCO","SANJERONIMO","SANJOSEDELAMONTAÑA","SANJUANDEURABA","SANLUIS","SANPEDRO","SANPEDRODEURABA","SANRAFAEL","SANROQUE","SANVICENTE","SANTABARBARA","SANTAROSADEOSOS","SANTODOMINGO","ELSANTUARIO","SEGOVIA","SONSON","SOPETRAN","TAMESIS","TARAZA","TARSO","TITIRIBI","TOLEDO","TURBO","URAMITA","URRAO","VALDIVIA","VALPARAISO","VEGACHI","VENECIA","VIGIADELFUERTE","YALI","YARUMAL","YOLOMBO","YONDO","ZARAGOZA","BARRANQUILLA","BARANOA","CAMPODELACRUZ","CANDELARIA","GALAPA","JUANDEACOSTA",
                                                   "LURUACO","MALAMBO","MANATI","PALMARDEVARELA","PIOJO","POLONUEVO","PONEDERA","PUERTOCOLOMBIA","REPELON","SABANAGRANDE","SABANALARGA","SANTALUCIA","SANTOTOMAS","SOLEDAD","SUAN","TUBARA","USIACURI","BOGOTA,D.C.","CARTAGENA","ACHI","ALTOSDELROSARIO","ARENAL","ARJONA","ARROYOHONDO","BARRANCODELOBA","CALAMAR","CANTAGALLO","CICUCO","CORDOBA","CLEMENCIA","ELCARMENDEBOLIVAR","ELGUAMO","ELPEÑON","HATILLODELOBA","MAGANGUE","MAHATES","MARGARITA","MARIALABAJA","MONTECRISTO","MOMPOS","NOROSI","MORALES","PINILLOS","REGIDOR","RIOVIEJO","SANCRISTOBAL","SANESTANISLAO","SANFERNANDO","SANJACINTO","SANJACINTODELCAUCA","SANJUANNEPOMUCENO","SANMARTINDELOBA","SANPABLO","SANTACATALINA","SANTAROSA","SANTAROSADELSUR","SIMITI","SOPLAVIENTO","TALAIGUANUEVO","TIQUISIO",
                                                   "TURBACO","TURBANA","VILLANUEVA","ZAMBRANO","TUNJA","ALMEIDA","AQUITANIA","ARCABUCO","BELEN","BERBEO","BETEITIVA","BOAVITA","BOYACA","BRICEÑO","BUENAVISTA","BUSBANZA","CALDAS","CAMPOHERMOSO","CERINZA","CHINAVITA","CHIQUINQUIRA","CHISCAS","CHITA","CHITARAQUE","CHIVATA","CIENEGA","COMBITA","COPER","CORRALES","COVARACHIA","CUBARA","CUCAITA","CUITIVA","CHIQUIZA","CHIVOR","DUITAMA","ELCOCUY","ELESPINO","FIRAVITOBA","FLORESTA","GACHANTIVA","GAMEZA","GARAGOA","GUACAMAYAS","GUATEQUE","GUAYATA","GsICAN","IZA","JENESANO","JERICO","LABRANZAGRANDE","LACAPILLA","LAVICTORIA","LAUVITA","VILLADELEYVA","MACANAL","MARIPI","MIRAFLORES","MONGUA","MONGUI","MONIQUIRA","MOTAVITA","MUZO","NOBSA","NUEVOCOLON","OICATA","OTANCHE","PACHAVITA","PAEZ","PAIPA","PAJARITO",
                                                   "PANQUEBA","PAUNA","PAYA","PAZDERIO","PESCA","PISBA","PUERTOBOYACA","QUIPAMA","RAMIRIQUI","RAQUIRA","RONDON","SABOYA","SACHICA","SAMACA","SANEDUARDO","SANJOSEDEPARE","SANLUISDEGACENO","SANMATEO","SANMIGUELDESEMA","SANPABLODEBORBUR","SANTANA","SANTAMARIA","SANTAROSADEVITERBO","SANTASOFIA","SATIVANORTE","SATIVASUR","SIACHOQUE","SOATA","SOCOTA","SOCHA","SOGAMOSO","SOMONDOCO","SORA","SOTAQUIRA","SORACA","SUSACON","SUTAMARCHAN","SUTATENZA","TASCO","TENZA","TIBANA","TIBASOSA","TINJACA","TIPACOQUE","TOCA","TOGsI","TOPAGA","TOTA","TUNUNGUA","TURMEQUE","TUTA","TUTAZA","UMBITA","VENTAQUEMADA","VIRACACHA","ZETAQUIRA","MANIZALES","AGUADAS","ANSERMA","ARANZAZU","BELALCAZAR","CHINCHINA","FILADELFIA","LADORADA","LAMERCED","MANZANARES","MARMATO","MARQUETALIA",
                                                   "MARULANDA","NEIRA","NORCASIA","PACORA","PALESTINA","PENSILVANIA","RIOSUCIO","RISARALDA","SALAMINA","SAMANA","SANJOSE","SUPIA","VICTORIA","VILLAMARIA","VITERBO","FLORENCIA","ALBANIA","BELENDELOSANDAQUIES","CARTAGENADELCHAIRA","CURILLO","ELDONCELLO","ELPAUJIL","LAMONTAÑITA","MILAN","MORELIA","PUERTORICO","SANJOSEDELFRAGUA","SANVICENTEDELCAGUAN","SOLANO","SOLITA","VALPARAISO","POPAYAN","ALMAGUER","ARGELIA","BALBOA","BOLIVAR","BUENOSAIRES","CAJIBIO","CALDONO","CALOTO","CORINTO","ELTAMBO","FLORENCIA","GUACHENE","GUAPI","INZA","JAMBALO","LASIERRA","LAVEGA","LOPEZ","MERCADERES","MIRANDA","MORALES","PADILLA","PAEZ","PATIA","PIAMONTE","PIENDAMO","PUERTOTEJADA","PURACE","ROSAS","SANSEBASTIAN","SANTANDERDEQUILICHAO","SANTAROSA","SILVIA","SOTARA","SUAREZ",
                                                   "SUCRE","TIMBIO","TIMBIQUI","TORIBIO","TOTORO","VILLARICA","VALLEDUPAR","AGUACHICA","AGUSTINCODAZZI","ASTREA","BECERRIL","BOSCONIA","CHIMICHAGUA","CHIRIGUANA","CURUMANI","ELCOPEY","ELPASO","GAMARRA","GONZALEZ","LAGLORIA","LAJAGUADEIBIRICO","MANAURE","PAILITAS","PELAYA","PUEBLOBELLO","RIODEORO","LAPAZ","SANALBERTO","SANDIEGO","SANMARTIN","TAMALAMEQUE","MONTERIA","AYAPEL","BUENAVISTA","CANALETE","CERETE","CHIMA","CHINU","CIENAGADEORO","COTORRA","LAAPARTADA","LORICA","LOSCORDOBAS","MOMIL","MONTELIBANO","MOÑITOS","PLANETARICA","PUEBLONUEVO","PUERTOESCONDIDO","PUERTOLIBERTADOR","PURISIMA","SAHAGUN","SANANDRESSOTAVENTO","SANANTERO","SANBERNARDODELVIENTO","SANCARLOS","SANPELAYO","TIERRALTA","VALENCIA","AGUADEDIOS","ALBAN","ANAPOIMA","ANOLAIMA","ARBELAEZ",
                                                   "BELTRAN","BITUIMA","BOJACA","CABRERA","CACHIPAY","CAJICA","CAPARRAPI","CAQUEZA","CARMENDECARUPA","CHAGUANI","CHIA","CHIPAQUE","CHOACHI","CHOCONTA","COGUA","COTA","CUCUNUBA","ELCOLEGIO","ELPEÑON","ELROSAL","FACATATIVA","FOMEQUE","FOSCA","FUNZA","FUQUENE","FUSAGASUGA","GACHALA","GACHANCIPA","GACHETA","GAMA","GIRARDOT","GRANADA","GUACHETA","GUADUAS","GUASCA","GUATAQUI","GUATAVITA","GUAYABALDESIQUIMA","GUAYABETAL","GUTIERREZ","JERUSALEN","JUNIN","LACALERA","LAMESA","LAPALMA","LAPEÑA","LAVEGA","LENGUAZAQUE","MACHETA","MADRID","MANTA","MEDINA","MOSQUERA","NARIÑO","NEMOCON","NILO","NIMAIMA","NOCAIMA","VENECIA","PACHO","PAIME","PANDI","PARATEBUENO","PASCA","PUERTOSALGAR","PULI","QUEBRADANEGRA","QUETAME","QUIPILE","APULO","RICAURTE","SANANTONIODELTEQUENDAMA",
                                                   "SANBERNARDO","SANCAYETANO","SANFRANCISCO","SANJUANDERIOSECO","SASAIMA","SESQUILE","SIBATE","SILVANIA","SIMIJACA","SOACHA","SOPO","SUBACHOQUE","SUESCA","SUPATA","SUSA","SUTATAUSA","TABIO","TAUSA","TENA","TENJO","TIBACUY","TIBIRITA","TOCAIMA","TOCANCIPA","TOPAIPI","UBALA","UBAQUE","VILLADESANDIEGODEUBATE","UNE","UTICA","VERGARA","VIANI","VILLAGOMEZ","VILLAPINZON","VILLETA","VIOTA","YACOPI","ZIPACON","ZIPAQUIRA","QUIBDO","ACANDI","ALTOBAUDO","ATRATO","BAGADO","BAHIASOLANO","BAJOBAUDO","BOJAYA","ELCANTONDELSANPABLO","CARMENDELDARIEN","CERTEGUI","CONDOTO","ELCARMENDEATRATO","ELLITORALDELSANJUAN","ISTMINA","JURADO","LLORO","MEDIOATRATO","MEDIOBAUDO","MEDIOSANJUAN","NOVITA","NUQUI","RIOIRO","RIOQUITO","RIOSUCIO","SANJOSEDELPALMAR","SIPI","TADO","UNGUIA",
                                                   "UNIONPANAMERICANA","NEIVA","ACEVEDO","AGRADO","AIPE","ALGECIRAS","ALTAMIRA","BARAYA","CAMPOALEGRE","COLOMBIA","ELIAS","GARZON","GIGANTE","GUADALUPE","HOBO","IQUIRA","ISNOS","LAARGENTINA","LAPLATA","NATAGA","OPORAPA","PAICOL","PALERMO","PALESTINA","PITAL","PITALITO","RIVERA","SALADOBLANCO","SANAGUSTIN","SANTAMARIA","SUAZA","TARQUI","TESALIA","TELLO","TERUEL","TIMANA","VILLAVIEJA","YAGUARA","RIOHACHA","ALBANIA","BARRANCAS","DIBULLA","DISTRACCION","ELMOLINO","FONSECA","HATONUEVO","LAJAGUADELPILAR","MAICAO","MANAURE","SANJUANDELCESAR","URIBIA","URUMITA","VILLANUEVA","SANTAMARTA","ALGARROBO","ARACATACA","ARIGUANI","CERROSANANTONIO","CHIBOLO","CIENAGA","CONCORDIA","ELBANCO","ELPIÑON","ELRETEN","FUNDACION","GUAMAL","NUEVAGRANADA","PEDRAZA","PIJIÑODELCARMEN",
                                                   "PIVIJAY","PLATO","PUEBLOVIEJO","REMOLINO","SABANASDESANANGEL","SALAMINA","SANSEBASTIANDEBUENAVISTA","SANZENON","SANTAANA","SANTABARBARADEPINTO","SITIONUEVO","TENERIFE","ZAPAYAN","ZONABANANERA","VILLAVICENCIO","ACACIAS","BARRANCADEUPIA","CABUYARO","CASTILLALANUEVA","CUBARRAL","CUMARAL","ELCALVARIO","ELCASTILLO","ELDORADO","FUENTEDEORO","GRANADA","GUAMAL","MAPIRIPAN","MESETAS","LAMACARENA","URIBE","LEJANIAS","PUERTOCONCORDIA","PUERTOGAITAN","PUERTOLOPEZ","PUERTOLLERAS","PUERTORICO","RESTREPO","SANCARLOSDEGUAROA","SANJUANDEARAMA","SANJUANITO","SANMARTIN","VISTAHERMOSA","PASTO","ALBAN","ALDANA","ANCUYA","ARBOLEDA","BARBACOAS","BELEN","BUESACO","COLON","CONSACA","CONTADERO","CORDOBA","CUASPUD","CUMBAL","CUMBITARA","CHACHAGsI","ELCHARCO","ELPEÑOL","ELROSARIO",
                                                   "ELTABLONDEGOMEZ","ELTAMBO","FUNES","GUACHUCAL","GUAITARILLA","GUALMATAN","ILES","IMUES","IPIALES","LACRUZ","LAFLORIDA","LALLANADA","LATOLA","LAUNION","LEIVA","LINARES","LOSANDES","MAGsI","MALLAMA","MOSQUERA","NARIÑO","OLAYAHERRERA","OSPINA","FRANCISCOPIZARRO","POLICARPA","POTOSI","PROVIDENCIA","PUERRES","PUPIALES","RICAURTE","ROBERTOPAYAN","SAMANIEGO","SANDONA","SANBERNARDO","SANLORENZO","SANPABLO","SANPEDRODECARTAGO","SANTABARBARA","SANTACRUZ","SAPUYES","TAMINANGO","TANGUA","SANANDRESDETUMACO","TUQUERRES","YACUANQUER","CUCUTA","ABREGO","ARBOLEDAS","BOCHALEMA","BUCARASICA","CACOTA","CACHIRA","CHINACOTA","CHITAGA","CONVENCION","CUCUTILLA","DURANIA","ELCARMEN","ELTARRA","ELZULIA","GRAMALOTE","HACARI","HERRAN","LABATECA","LAESPERANZA","LAPLAYA","LOSPATIOS",
                                                   "LOURDES","MUTISCUA","OCAÑA","PAMPLONA","PAMPLONITA","PUERTOSANTANDER","RAGONVALIA","SALAZAR","SANCALIXTO","SANCAYETANO","SANTIAGO","SARDINATA","SILOS","TEORAMA","TIBU","TOLEDO","VILLACARO","VILLADELROSARIO","ARMENIA","BUENAVISTA","CALARCA","CIRCASIA","CORDOBA","FILANDIA","GENOVA","LATEBAIDA","MONTENEGRO","PIJAO","QUIMBAYA","SALENTO","PEREIRA","APIA","BALBOA","BELENDEUMBRIA","DOSQUEBRADAS","GUATICA","LACELIA","LAVIRGINIA","MARSELLA","MISTRATO","PUEBLORICO","QUINCHIA","SANTAROSADECABAL","SANTUARIO","BUCARAMANGA","AGUADA","ALBANIA","ARATOCA","BARBOSA","BARICHARA","BARRANCABERMEJA","BETULIA","BOLIVAR","CABRERA","CALIFORNIA","CAPITANEJO","CARCASI","CEPITA","CERRITO","CHARALA","CHARTA","CHIMA","CHIPATA","CIMITARRA","CONCEPCION","CONFINES","CONTRATACION",
                                                   "COROMORO","CURITI","ELCARMENDECHUCURI","ELGUACAMAYO","ELPEÑON","ELPLAYON","ENCINO","ENCISO","FLORIAN","FLORIDABLANCA","GALAN","GAMBITA","GIRON","GUACA","GUADALUPE","GUAPOTA","GUAVATA","GsEPSA","HATO","JESUSMARIA","JORDAN","LABELLEZA","LANDAZURI","LAPAZ","LEBRIJA","LOSSANTOS","MACARAVITA","MALAGA","MATANZA","MOGOTES","MOLAGAVITA","OCAMONTE","OIBA","ONZAGA","PALMAR","PALMASDELSOCORRO","PARAMO","PIEDECUESTA","PINCHOTE","PUENTENACIONAL","PUERTOPARRA","PUERTOWILCHES","RIONEGRO","SABANADETORRES","SANANDRES","SANBENITO","SANGIL","SANJOAQUIN","SANJOSEDEMIRANDA","SANMIGUEL","SANVICENTEDECHUCURI","SANTABARBARA","SANTAHELENADELOPON","SIMACOTA","SOCORRO","SUAITA","SUCRE","SURATA","TONA","VALLEDESANJOSE","VELEZ","VETAS","VILLANUEVA","ZAPATOCA","SINCELEJO",
                                                   "BUENAVISTA","CAIMITO","COLOSO","COROZAL","COVEÑAS","CHALAN","ELROBLE","GALERAS","GUARANDA","LAUNION","LOSPALMITOS","MAJAGUAL","MORROA","OVEJAS","PALMITO","SAMPUES","SANBENITOABAD","SANJUANDEBETULIA","SANMARCOS","SANONOFRE","SANPEDRO","SANLUISDESINCE","SUCRE","SANTIAGODETOLU","TOLUVIEJO","IBAGUE","ALPUJARRA","ALVARADO","AMBALEMA","ANZOATEGUI","ARMERO","ATACO","CAJAMARCA","CARMENDEAPICALA","CASABIANCA","CHAPARRAL","COELLO","COYAIMA","CUNDAY","DOLORES","ESPINAL","FALAN","FLANDES","FRESNO","GUAMO","HERVEO","HONDA","ICONONZO","LERIDA","LIBANO","MARIQUITA","MELGAR","MURILLO","NATAGAIMA","ORTEGA","PALOCABILDO","PIEDRAS","PLANADAS","PRADO","PURIFICACION","RIOBLANCO","RONCESVALLES","ROVIRA","SALDAÑA","SANANTONIO","SANLUIS","SANTAISABEL","SUAREZ","VALLEDESANJUAN",
                                                   "VENADILLO","VILLAHERMOSA","VILLARRICA","CALI","ALCALA","ANDALUCIA","ANSERMANUEVO","ARGELIA","BOLIVAR","BUENAVENTURA","GUADALAJARADEBUGA","BUGALAGRANDE","CAICEDONIA","CALIMA","CANDELARIA","CARTAGO","DAGUA","ELAGUILA","ELCAIRO","ELCERRITO","ELDOVIO","FLORIDA","GINEBRA","GUACARI","JAMUNDI","LACUMBRE","LAUNION","LAVICTORIA","OBANDO","PALMIRA","PRADERA","RESTREPO","RIOFRIO","ROLDANILLO","SANPEDRO","SEVILLA","TORO","TRUJILLO","TULUA","ULLOA","VERSALLES","VIJES","YOTOCO","YUMBO","ZARZAL","ARAUCA","ARAUQUITA","CRAVONORTE","FORTUL","PUERTORONDON","SARAVENA","TAME","YOPAL","AGUAZUL","CHAMEZA","HATOCOROZAL","LASALINA","MANI","MONTERREY","NUNCHIA","OROCUE","PAZDEARIPORO","PORE","RECETOR","SABANALARGA","SACAMA","SANLUISDEPALENQUE","TAMARA","TAURAMENA","TRINIDAD",
                                                   "VILLANUEVA","MOCOA","COLON","ORITO","PUERTOASIS","PUERTOCAICEDO","PUERTOGUZMAN","LEGUIZAMO","SIBUNDOY","SANFRANCISCO","SANMIGUEL","SANTIAGO","VALLEDELGUAMUEZ","VILLAGARZON","SANANDRES","PROVIDENCIA","LETICIA","ELENCANTO","LACHORRERA","LAPEDRERA","LAVICTORIA","MIRITI-PARANA","PUERTOALEGRIA","PUERTOARICA","PUERTONARIÑO","PUERTOSANTANDER","TARAPACA","INIRIDA","BARRANCOMINAS","MAPIRIPANA","SANFELIPE","PUERTOCOLOMBIA","LAGUADALUPE","CACAHUAL","PANAPANA","MORICHAL","SANJOSEDELGUAVIARE","CALAMAR","ELRETORNO","MIRAFLORES","MITU","CARURU","PACOA","TARAIRA","PAPUNAUA","YAVARATE","PUERTOCARREÑO","LAPRIMAVERA","SANTAROSALIA","CUMARIBO"))

# Eliminar columna 9 "divcentropoblad2" es igual que dicentropoblado
colnames(prueba_c)[10] <- "parto_atendido_por"
prueba_c$parto_atendido_por <- factor(prueba_c$parto_atendido_por, levels = c(1:6),labels =c("medico","enfermero","auxiliar_enfermeria","promotor_salud","partera","otro"), ordered = TRUE) 
# # Eliminar columna 11 "estado certificado" no interesa
colnames(prueba_c)[12] <- "educ_padre"
prueba_c$educ_padre <- factor(prueba_c$educ_padre, levels = c(1:14),labels =c("Preescolar","Básica primaria","Básica secundaria", "Media académica o clásica","Media técnica","Normalista","Técnica profesional","Tecnológica", "Profesional","Especialización","Maestría","Doctorado","Ninguno","desconocido"), ordered = TRUE) 
# eliminar 13, pueblo indigena
# eliminar 14, es el id de l certificador
colnames(prueba_c)[15] <- "pertenencia_etnica"
prueba_c$pertenencia_etnica <- factor(prueba_c$pertenencia_etnica, levels = c(1:6),labels =c("indigena","rom","raizal", "palenquero","negro_afro_mulato","ninguno"), ordered = TRUE) 
colnames(prueba_c)[16] <- "estado_conyugal"
prueba_c$estado_conyugal <- factor(prueba_c$estado_conyugal, levels = c(1:7),labels =c("dos años convivencia","menos de dos años convivencia","separada","viuda","soltera","casada","desconocido"), ordered = TRUE) 
# BOrrar 17 "cod paises" no aporta nada. 
colnames(prueba_c)[18] <- "area_nacimiento"
prueba_c$area_nacimiento <- factor(prueba_c$area_nacimiento, levels = c(1:3),labels =c("cabecera","centro_poblado","rural_disperso"), ordered = TRUE)
colnames(prueba_c)[19] <- "area_reside_habitual"
prueba_c$area_reside_habitual <- factor(prueba_c$area_reside_habitual, levels = c(1:3),labels =c("cabecera","centro_poblado","rural_disperso"), ordered = TRUE)
# BOrrar 20, el tipo sanguineo no tiene coherencia en lo que se quiere estudiar
## BOrrar 21, el tipo factor RH no tiene coherencia en lo que se quiere estudiar
colnames(prueba_c)[22] <- "sexo"
prueba_c$sexo <- factor(prueba_c$sexo, levels = c(1,2),labels =c("masculino","femenino"), ordered = TRUE)
# localidad comuna ya es demasiado especifico 23
# institución de salud también [24]
colnames(prueba_c)[25] <- "sitio_parto"
prueba_c$sitio_parto <- factor(prueba_c$sitio_parto, levels = c(1:3),labels =c("institucion_salud","domicilio","otro"), ordered = TRUE)
colnames(prueba_c)[26] <- "peso_nacer"
colnames(prueba_c)[27] <- "talla"
colnames(prueba_c)[28] <- "fecha_nac_def"
# eliminar 29 es la respuesta a otro sitio de parto
# eliminar 30 es la respuesta a otro que atendió el parto
colnames(prueba_c)[31] <- "tiempo_gestacion"
colnames(prueba_c)[32] <- "numero_cpn"
colnames(prueba_c)[33] <- "apgar_1"
colnames(prueba_c)[34] <- "apgar_5"
colnames(prueba_c)[35] <- "edad_materna"
# eliminar 36, ya contamos con educación y esta es el ultimo curso especifico
# eliminar 37, es otra respuesta a otra categoría
# eliminar 38, es la fecha de nacimiento de su hijo anterior
colnames(prueba_c)[39] <- "numero_nacidos_vivos"
colnames(prueba_c)[40] <- "numero_embarazos"
colnames(prueba_c)[41] <- "edad_paterna"
# eliminar 42, curso especifico del padre
colnames(prueba_c)[43] <- "fecha_expedicion"#considerar eliminar
# eliminar 44, es otra respuesta a otra categoría
# eliminar 45, es otra respuesta a otra categoría
# eliminar 46, es la fecha de confirmación
# eliminar 47, es el lugar de expedición, con el resto de información ya tenemos
# eliminar 48, es la fecha de úlitma modificación, no es de nuestro interés
colnames(prueba_c)[49] <- "municipio_nacimiento"
prueba_c$municipio_nacimiento <- factor(prueba_c$municipio_nacimiento, 
                                        levels=c(5001,5002,5004,5021,5030,5031,5034,5036,5038,5040,5042,5044,5045,5051,5055,5059,5079,5086,5088,5091,5093,5101,5107,5113,5120,5125,5129,5134,5138,5142,5145,5147,5148,5150,5154,5172,5190,5197,5206,5209,5212,5234,5237,5240,5250,5264,5266,5282,5284,5306,5308,5310,5313,5315,5318,5321,5347,5353,5360,5361,5364,5368,5376,5380,5390,5400,5411,5425,5440,5467,5475,5480,5483,5490,5495,5501,5541,5543,5576,5579,5585,5591,5604,5607,5615,5628,5631,5642,5647,5649,5652,5656,5658,5659,5660,5664,5665,5667,5670,5674,5679,5686,5690,5697,5736,5756,5761,5789,5790,5792,5809,5819,5837,5842,5847,5854,5856,5858,5861,5873,5885,5887,5890,5893,5895,8001,8078,8137,8141,8296,8372,8421,8433,8436,8520,8549,8558,8560,8573,8606,8634,8638,8675,8685,8758,8770,8832,8849
                                                 ,11001,13001,13006,13030,13042,13052,13062,13074,13140,13160,13188,13212,13222,13244,13248,13268,13300,13430,13433,13440,13442,13458,13468,13490,13473,13549,13580,13600,13620,13647,13650,13654,13655,13657,13667,13670,13673,13683,13688,13744,13760,13780,13810,13836,13838,13873,13894,15001,15022,15047,15051,15087,15090,15092,15097,15104,15106,15109,15114,15131,15135,15162,15172,15176,15180,15183,15185,15187,15189,15204,15212,15215,15218,15223,15224,15226,15232,15236,15238,15244,15248,15272,15276,15293,15296,15299,15317,15322,15325,15332,15362,15367,15368,15377,15380,15401,15403,15407,15425,15442,15455,15464,15466,15469,15476,15480,15491,15494,15500,15507,15511,15514,15516,15518,15522,15531,15533,15537,15542,15550,15572,15580,15599,
                                                 15600,15621,15632,15638,15646,15660,15664,15667,15673,15676,15681,15686,15690,15693,15696,15720,15723,15740,15753,15755,15757,15759,15761,15762,15763,15764,15774,15776,15778,15790,15798,15804,15806,15808,15810,15814,15816,15820,15822,15832,15835,15837,15839,15842,15861,15879,15897,17001,17013,17042,17050,17088,17174,17272,17380,17388,17433,17442,17444,17446,17486,17495,17513,17524,17541,17614,17616,17653,17662,17665,17777,17867,17873,17877,18001,18029,18094,18150,18205,18247,18256,18410,18460,18479,18592,18610,18753,18756,18785,18860,19001,19022,19050,19075,19100,19110,19130,19137,19142,19212,19256,19290,19300,19318,19355,19364,19392,19397,19418,19450,19455,19473,19513,19517,19532,19533,19548,19573,19585,19622,19693,19698,19701,
                                                 19743,19760,19780,19785,19807,19809,19821,19824,19845,20001,20011,20013,20032,20045,20060,20175,20178,20228,20238,20250,20295,20310,20383,20400,20443,20517,20550,20570,20614,20621,20710,20750,20770,20787,23001,23068,23079,23090,23162,23168,23182,23189,23300,23350,23417,23419,23464,23466,23500,23555,23570,23574,23580,23586,23660,23670,23672,23675,23678,23686,23807,23855,25001,25019,25035,25040,25053,25086,25095,25099,25120,25123,25126,25148,25151,25154,25168,25175,25178,25181,25183,25200,25214,25224,25245,25258,25260,25269,25279,25281,25286,25288,25290,25293,25295,25297,25299,25307,25312,25317,25320,25322,25324,25326,25328,25335,25339,25368,25372,25377,25386,25394,25398,25402,25407,25426,25430,25436,25438,25473,25483,25486,25488,
                                                 25489,25491,25506,25513,25518,25524,25530,25535,25572,25580,25592,25594,25596,25599,25612,25645,25649,25653,25658,25662,25718,25736,25740,25743,25745,25754,25758,25769,25772,25777,25779,25781,25785,25793,25797,25799,25805,25807,25815,25817,25823,25839,25841,25843,25845,25851,25862,25867,25871,25873,25875,25878,25885,25898,25899,27001,27006,27025,27050,27073,27075,27077,27099,27135,27150,27160,27205,27245,27250,27361,27372,27413,27425,27430,27450,27491,27495,27580,27600,27615,27660,27745,27787,27800,27810,41001,41006,41013,41016,41020,41026,41078,41132,41206,41244,41298,41306,41319,41349,41357,41359,41378,41396,41483,41503,41518,41524,41530,41548,41551,41615,41660,41668,41676,41770,41791,41797,41799,41801,41807,41872,41885,44001,
                                                 44035,44078,44090,44098,44110,44279,44378,44420,44430,44560,44650,44847,44855,44874,47001,47030,47053,47058,47161,47170,47189,47205,47245,47258,47268,47288,47318,47460,47541,47545,47551,47555,47570,47605,47660,47675,47692,47703,47707,47720,47745,47798,47960,47980,50001,50006,50110,50124,50150,50223,50226,50245,50251,50270,50287,50313,50318,50325,50330,50350,50370,50400,50450,50568,50573,50577,50590,50606,50680,50683,50686,50689,50711,52001,52019,52022,52036,52051,52079,52083,52110,52203,52207,52210,52215,52224,52227,52233,52240,52250,52254,52256,52258,52260,52287,52317,52320,52323,52352,52354,52356,52378,52381,52385,52390,52399,52405,52411,52418,52427,52435,52473,52480,52490,52506,52520,52540,52560,52565,52573,52585,52612,52621,
                                                 52678,52683,52685,52687,52693,52694,52696,52699,52720,52786,52788,52835,52838,52885,54001,54003,54051,54099,54109,54125,54128,54172,54174,54206,54223,54239,54245,54250,54261,54313,54344,54347,54377,54385,54398,54405,54418,54480,54498,54518,54520,54553,54599,54660,54670,54673,54680,54720,54743,54800,54810,54820,54871,54874,63001,63111,63130,63190,63212,63272,63302,63401,63470,63548,63594,63690,66001,66045,66075,66088,66170,66318,66383,66400,66440,66456,66572,66594,66682,66687,68001,68013,68020,68051,68077,68079,68081,68092,68101,68121,68132,68147,68152,68160,68162,68167,68169,68176,68179,68190,68207,68209,68211,68217,68229,68235,68245,68250,68255,68264,68266,68271,68276,68296,68298,68307,68318,68320,68322,68324,68327,68344,68368,
                                                 68370,68377,68385,68397,68406,68418,68425,68432,68444,68464,68468,68498,68500,68502,68522,68524,68533,68547,68549,68572,68573,68575,68615,68655,68669,68673,68679,68682,68684,68686,68689,68705,68720,68745,68755,68770,68773,68780,68820,68855,68861,68867,68872,68895,70001,70110,70124,70204,70215,70221,70230,70233,70235,70265,70400,70418,70429,70473,70508,70523,70670,70678,70702,70708,70713,70717,70742,70771,70820,70823,73001,73024,73026,73030,73043,73055,73067,73124,73148,73152,73168,73200,73217,73226,73236,73268,73270,73275,73283,73319,73347,73349,73352,73408,73411,73443,73449,73461,73483,73504,73520,73547,73555,73563,73585,73616,73622,73624,73671,73675,73678,73686,73770,73854,73861,73870,73873,76001,76020,76036,76041,76054,76100,
                                                 76109,76111,76113,76122,76126,76130,76147,76233,76243,76246,76248,76250,76275,76306,76318,76364,76377,76400,76403,76497,76520,76563,76606,76616,76622,76670,76736,76823,76828,76834,76845,76863,76869,76890,76892,76895,81001,81065,81220,81300,81591,81736,81794,85001,85010,85015,85125,85136,85139,85162,85225,85230,85250,85263,85279,85300,85315,85325,85400,85410,85430,85440,86001,86219,86320,86568,86569,86571,86573,86749,86755,86757,86760,86865,86885,88001,88564,91001,91263,91405,91407,91430,91460,91530,91536,91540,91669,91798,94001,94343,94663,94883,94884,94885,94886,94887,94888,95001,95015,95025,95200,97001,97161,97511,97666,97777,97889,99001,99524,99624,99773),
                                        labels = c("MEDELLIN","ABEJORRAL","ABRIAQUI","ALEJANDRIA","AMAGA","AMALFI","ANDES","ANGELOPOLIS","ANGOSTURA","ANORI","SANTAFEDEANTIOQUIA","ANZA","APARTADO","ARBOLETES","ARGELIA","ARMENIA","BARBOSA","BELMIRA","BELLO","BETANIA","BETULIA","CIUDADBOLIVAR","BRICEÑO","BURITICA","CACERES","CAICEDO","CALDAS","CAMPAMENTO","CAÑASGORDAS","CARACOLI","CARAMANTA","CAREPA","ELCARMENDEVIBORAL","CAROLINA","CAUCASIA","CHIGORODO","CISNEROS","COCORNA","CONCEPCION","CONCORDIA","COPACABANA","DABEIBA","DONMATIAS","EBEJICO","ELBAGRE","ENTRERRIOS","ENVIGADO","FREDONIA","FRONTINO","GIRALDO","GIRARDOTA","GOMEZPLATA","GRANADA","GUADALUPE","GUARNE","GUATAPE","HELICONIA","HISPANIA","ITAGUI","ITUANGO","JARDIN","JERICO","LACEJA","LAESTRELLA","LAPINTADA","LAUNION","LIBORINA",
                                                   "MACEO","MARINILLA","MONTEBELLO","MURINDO","MUTATA","NARIÑO","NECOCLI","NECHI","OLAYA","PEÐOL","PEQUE","PUEBLORRICO","PUERTOBERRIO","PUERTONARE","PUERTOTRIUNFO","REMEDIOS","RETIRO","RIONEGRO","SABANALARGA","SABANETA","SALGAR","SANANDRESDECUERQUIA","SANCARLOS","SANFRANCISCO","SANJERONIMO","SANJOSEDELAMONTAÑA","SANJUANDEURABA","SANLUIS","SANPEDRO","SANPEDRODEURABA","SANRAFAEL","SANROQUE","SANVICENTE","SANTABARBARA","SANTAROSADEOSOS","SANTODOMINGO","ELSANTUARIO","SEGOVIA","SONSON","SOPETRAN","TAMESIS","TARAZA","TARSO","TITIRIBI","TOLEDO","TURBO","URAMITA","URRAO","VALDIVIA","VALPARAISO","VEGACHI","VENECIA","VIGIADELFUERTE","YALI","YARUMAL","YOLOMBO","YONDO","ZARAGOZA","BARRANQUILLA","BARANOA","CAMPODELACRUZ","CANDELARIA","GALAPA","JUANDEACOSTA",
                                                   "LURUACO","MALAMBO","MANATI","PALMARDEVARELA","PIOJO","POLONUEVO","PONEDERA","PUERTOCOLOMBIA","REPELON","SABANAGRANDE","SABANALARGA","SANTALUCIA","SANTOTOMAS","SOLEDAD","SUAN","TUBARA","USIACURI","BOGOTA,D.C.","CARTAGENA","ACHI","ALTOSDELROSARIO","ARENAL","ARJONA","ARROYOHONDO","BARRANCODELOBA","CALAMAR","CANTAGALLO","CICUCO","CORDOBA","CLEMENCIA","ELCARMENDEBOLIVAR","ELGUAMO","ELPEÑON","HATILLODELOBA","MAGANGUE","MAHATES","MARGARITA","MARIALABAJA","MONTECRISTO","MOMPOS","NOROSI","MORALES","PINILLOS","REGIDOR","RIOVIEJO","SANCRISTOBAL","SANESTANISLAO","SANFERNANDO","SANJACINTO","SANJACINTODELCAUCA","SANJUANNEPOMUCENO","SANMARTINDELOBA","SANPABLO","SANTACATALINA","SANTAROSA","SANTAROSADELSUR","SIMITI","SOPLAVIENTO","TALAIGUANUEVO","TIQUISIO",
                                                   "TURBACO","TURBANA","VILLANUEVA","ZAMBRANO","TUNJA","ALMEIDA","AQUITANIA","ARCABUCO","BELEN","BERBEO","BETEITIVA","BOAVITA","BOYACA","BRICEÑO","BUENAVISTA","BUSBANZA","CALDAS","CAMPOHERMOSO","CERINZA","CHINAVITA","CHIQUINQUIRA","CHISCAS","CHITA","CHITARAQUE","CHIVATA","CIENEGA","COMBITA","COPER","CORRALES","COVARACHIA","CUBARA","CUCAITA","CUITIVA","CHIQUIZA","CHIVOR","DUITAMA","ELCOCUY","ELESPINO","FIRAVITOBA","FLORESTA","GACHANTIVA","GAMEZA","GARAGOA","GUACAMAYAS","GUATEQUE","GUAYATA","GsICAN","IZA","JENESANO","JERICO","LABRANZAGRANDE","LACAPILLA","LAVICTORIA","LAUVITA","VILLADELEYVA","MACANAL","MARIPI","MIRAFLORES","MONGUA","MONGUI","MONIQUIRA","MOTAVITA","MUZO","NOBSA","NUEVOCOLON","OICATA","OTANCHE","PACHAVITA","PAEZ","PAIPA","PAJARITO",
                                                   "PANQUEBA","PAUNA","PAYA","PAZDERIO","PESCA","PISBA","PUERTOBOYACA","QUIPAMA","RAMIRIQUI","RAQUIRA","RONDON","SABOYA","SACHICA","SAMACA","SANEDUARDO","SANJOSEDEPARE","SANLUISDEGACENO","SANMATEO","SANMIGUELDESEMA","SANPABLODEBORBUR","SANTANA","SANTAMARIA","SANTAROSADEVITERBO","SANTASOFIA","SATIVANORTE","SATIVASUR","SIACHOQUE","SOATA","SOCOTA","SOCHA","SOGAMOSO","SOMONDOCO","SORA","SOTAQUIRA","SORACA","SUSACON","SUTAMARCHAN","SUTATENZA","TASCO","TENZA","TIBANA","TIBASOSA","TINJACA","TIPACOQUE","TOCA","TOGsI","TOPAGA","TOTA","TUNUNGUA","TURMEQUE","TUTA","TUTAZA","UMBITA","VENTAQUEMADA","VIRACACHA","ZETAQUIRA","MANIZALES","AGUADAS","ANSERMA","ARANZAZU","BELALCAZAR","CHINCHINA","FILADELFIA","LADORADA","LAMERCED","MANZANARES","MARMATO","MARQUETALIA",
                                                   "MARULANDA","NEIRA","NORCASIA","PACORA","PALESTINA","PENSILVANIA","RIOSUCIO","RISARALDA","SALAMINA","SAMANA","SANJOSE","SUPIA","VICTORIA","VILLAMARIA","VITERBO","FLORENCIA","ALBANIA","BELENDELOSANDAQUIES","CARTAGENADELCHAIRA","CURILLO","ELDONCELLO","ELPAUJIL","LAMONTAÑITA","MILAN","MORELIA","PUERTORICO","SANJOSEDELFRAGUA","SANVICENTEDELCAGUAN","SOLANO","SOLITA","VALPARAISO","POPAYAN","ALMAGUER","ARGELIA","BALBOA","BOLIVAR","BUENOSAIRES","CAJIBIO","CALDONO","CALOTO","CORINTO","ELTAMBO","FLORENCIA","GUACHENE","GUAPI","INZA","JAMBALO","LASIERRA","LAVEGA","LOPEZ","MERCADERES","MIRANDA","MORALES","PADILLA","PAEZ","PATIA","PIAMONTE","PIENDAMO","PUERTOTEJADA","PURACE","ROSAS","SANSEBASTIAN","SANTANDERDEQUILICHAO","SANTAROSA","SILVIA","SOTARA","SUAREZ",
                                                   "SUCRE","TIMBIO","TIMBIQUI","TORIBIO","TOTORO","VILLARICA","VALLEDUPAR","AGUACHICA","AGUSTINCODAZZI","ASTREA","BECERRIL","BOSCONIA","CHIMICHAGUA","CHIRIGUANA","CURUMANI","ELCOPEY","ELPASO","GAMARRA","GONZALEZ","LAGLORIA","LAJAGUADEIBIRICO","MANAURE","PAILITAS","PELAYA","PUEBLOBELLO","RIODEORO","LAPAZ","SANALBERTO","SANDIEGO","SANMARTIN","TAMALAMEQUE","MONTERIA","AYAPEL","BUENAVISTA","CANALETE","CERETE","CHIMA","CHINU","CIENAGADEORO","COTORRA","LAAPARTADA","LORICA","LOSCORDOBAS","MOMIL","MONTELIBANO","MOÑITOS","PLANETARICA","PUEBLONUEVO","PUERTOESCONDIDO","PUERTOLIBERTADOR","PURISIMA","SAHAGUN","SANANDRESSOTAVENTO","SANANTERO","SANBERNARDODELVIENTO","SANCARLOS","SANPELAYO","TIERRALTA","VALENCIA","AGUADEDIOS","ALBAN","ANAPOIMA","ANOLAIMA","ARBELAEZ",
                                                   "BELTRAN","BITUIMA","BOJACA","CABRERA","CACHIPAY","CAJICA","CAPARRAPI","CAQUEZA","CARMENDECARUPA","CHAGUANI","CHIA","CHIPAQUE","CHOACHI","CHOCONTA","COGUA","COTA","CUCUNUBA","ELCOLEGIO","ELPEÑON","ELROSAL","FACATATIVA","FOMEQUE","FOSCA","FUNZA","FUQUENE","FUSAGASUGA","GACHALA","GACHANCIPA","GACHETA","GAMA","GIRARDOT","GRANADA","GUACHETA","GUADUAS","GUASCA","GUATAQUI","GUATAVITA","GUAYABALDESIQUIMA","GUAYABETAL","GUTIERREZ","JERUSALEN","JUNIN","LACALERA","LAMESA","LAPALMA","LAPEÑA","LAVEGA","LENGUAZAQUE","MACHETA","MADRID","MANTA","MEDINA","MOSQUERA","NARIÑO","NEMOCON","NILO","NIMAIMA","NOCAIMA","VENECIA","PACHO","PAIME","PANDI","PARATEBUENO","PASCA","PUERTOSALGAR","PULI","QUEBRADANEGRA","QUETAME","QUIPILE","APULO","RICAURTE","SANANTONIODELTEQUENDAMA",
                                                   "SANBERNARDO","SANCAYETANO","SANFRANCISCO","SANJUANDERIOSECO","SASAIMA","SESQUILE","SIBATE","SILVANIA","SIMIJACA","SOACHA","SOPO","SUBACHOQUE","SUESCA","SUPATA","SUSA","SUTATAUSA","TABIO","TAUSA","TENA","TENJO","TIBACUY","TIBIRITA","TOCAIMA","TOCANCIPA","TOPAIPI","UBALA","UBAQUE","VILLADESANDIEGODEUBATE","UNE","UTICA","VERGARA","VIANI","VILLAGOMEZ","VILLAPINZON","VILLETA","VIOTA","YACOPI","ZIPACON","ZIPAQUIRA","QUIBDO","ACANDI","ALTOBAUDO","ATRATO","BAGADO","BAHIASOLANO","BAJOBAUDO","BOJAYA","ELCANTONDELSANPABLO","CARMENDELDARIEN","CERTEGUI","CONDOTO","ELCARMENDEATRATO","ELLITORALDELSANJUAN","ISTMINA","JURADO","LLORO","MEDIOATRATO","MEDIOBAUDO","MEDIOSANJUAN","NOVITA","NUQUI","RIOIRO","RIOQUITO","RIOSUCIO","SANJOSEDELPALMAR","SIPI","TADO","UNGUIA",
                                                   "UNIONPANAMERICANA","NEIVA","ACEVEDO","AGRADO","AIPE","ALGECIRAS","ALTAMIRA","BARAYA","CAMPOALEGRE","COLOMBIA","ELIAS","GARZON","GIGANTE","GUADALUPE","HOBO","IQUIRA","ISNOS","LAARGENTINA","LAPLATA","NATAGA","OPORAPA","PAICOL","PALERMO","PALESTINA","PITAL","PITALITO","RIVERA","SALADOBLANCO","SANAGUSTIN","SANTAMARIA","SUAZA","TARQUI","TESALIA","TELLO","TERUEL","TIMANA","VILLAVIEJA","YAGUARA","RIOHACHA","ALBANIA","BARRANCAS","DIBULLA","DISTRACCION","ELMOLINO","FONSECA","HATONUEVO","LAJAGUADELPILAR","MAICAO","MANAURE","SANJUANDELCESAR","URIBIA","URUMITA","VILLANUEVA","SANTAMARTA","ALGARROBO","ARACATACA","ARIGUANI","CERROSANANTONIO","CHIBOLO","CIENAGA","CONCORDIA","ELBANCO","ELPIÑON","ELRETEN","FUNDACION","GUAMAL","NUEVAGRANADA","PEDRAZA","PIJIÑODELCARMEN",
                                                   "PIVIJAY","PLATO","PUEBLOVIEJO","REMOLINO","SABANASDESANANGEL","SALAMINA","SANSEBASTIANDEBUENAVISTA","SANZENON","SANTAANA","SANTABARBARADEPINTO","SITIONUEVO","TENERIFE","ZAPAYAN","ZONABANANERA","VILLAVICENCIO","ACACIAS","BARRANCADEUPIA","CABUYARO","CASTILLALANUEVA","CUBARRAL","CUMARAL","ELCALVARIO","ELCASTILLO","ELDORADO","FUENTEDEORO","GRANADA","GUAMAL","MAPIRIPAN","MESETAS","LAMACARENA","URIBE","LEJANIAS","PUERTOCONCORDIA","PUERTOGAITAN","PUERTOLOPEZ","PUERTOLLERAS","PUERTORICO","RESTREPO","SANCARLOSDEGUAROA","SANJUANDEARAMA","SANJUANITO","SANMARTIN","VISTAHERMOSA","PASTO","ALBAN","ALDANA","ANCUYA","ARBOLEDA","BARBACOAS","BELEN","BUESACO","COLON","CONSACA","CONTADERO","CORDOBA","CUASPUD","CUMBAL","CUMBITARA","CHACHAGsI","ELCHARCO","ELPEÑOL","ELROSARIO",
                                                   "ELTABLONDEGOMEZ","ELTAMBO","FUNES","GUACHUCAL","GUAITARILLA","GUALMATAN","ILES","IMUES","IPIALES","LACRUZ","LAFLORIDA","LALLANADA","LATOLA","LAUNION","LEIVA","LINARES","LOSANDES","MAGsI","MALLAMA","MOSQUERA","NARIÑO","OLAYAHERRERA","OSPINA","FRANCISCOPIZARRO","POLICARPA","POTOSI","PROVIDENCIA","PUERRES","PUPIALES","RICAURTE","ROBERTOPAYAN","SAMANIEGO","SANDONA","SANBERNARDO","SANLORENZO","SANPABLO","SANPEDRODECARTAGO","SANTABARBARA","SANTACRUZ","SAPUYES","TAMINANGO","TANGUA","SANANDRESDETUMACO","TUQUERRES","YACUANQUER","CUCUTA","ABREGO","ARBOLEDAS","BOCHALEMA","BUCARASICA","CACOTA","CACHIRA","CHINACOTA","CHITAGA","CONVENCION","CUCUTILLA","DURANIA","ELCARMEN","ELTARRA","ELZULIA","GRAMALOTE","HACARI","HERRAN","LABATECA","LAESPERANZA","LAPLAYA","LOSPATIOS",
                                                   "LOURDES","MUTISCUA","OCAÑA","PAMPLONA","PAMPLONITA","PUERTOSANTANDER","RAGONVALIA","SALAZAR","SANCALIXTO","SANCAYETANO","SANTIAGO","SARDINATA","SILOS","TEORAMA","TIBU","TOLEDO","VILLACARO","VILLADELROSARIO","ARMENIA","BUENAVISTA","CALARCA","CIRCASIA","CORDOBA","FILANDIA","GENOVA","LATEBAIDA","MONTENEGRO","PIJAO","QUIMBAYA","SALENTO","PEREIRA","APIA","BALBOA","BELENDEUMBRIA","DOSQUEBRADAS","GUATICA","LACELIA","LAVIRGINIA","MARSELLA","MISTRATO","PUEBLORICO","QUINCHIA","SANTAROSADECABAL","SANTUARIO","BUCARAMANGA","AGUADA","ALBANIA","ARATOCA","BARBOSA","BARICHARA","BARRANCABERMEJA","BETULIA","BOLIVAR","CABRERA","CALIFORNIA","CAPITANEJO","CARCASI","CEPITA","CERRITO","CHARALA","CHARTA","CHIMA","CHIPATA","CIMITARRA","CONCEPCION","CONFINES","CONTRATACION",
                                                   "COROMORO","CURITI","ELCARMENDECHUCURI","ELGUACAMAYO","ELPEÑON","ELPLAYON","ENCINO","ENCISO","FLORIAN","FLORIDABLANCA","GALAN","GAMBITA","GIRON","GUACA","GUADALUPE","GUAPOTA","GUAVATA","GsEPSA","HATO","JESUSMARIA","JORDAN","LABELLEZA","LANDAZURI","LAPAZ","LEBRIJA","LOSSANTOS","MACARAVITA","MALAGA","MATANZA","MOGOTES","MOLAGAVITA","OCAMONTE","OIBA","ONZAGA","PALMAR","PALMASDELSOCORRO","PARAMO","PIEDECUESTA","PINCHOTE","PUENTENACIONAL","PUERTOPARRA","PUERTOWILCHES","RIONEGRO","SABANADETORRES","SANANDRES","SANBENITO","SANGIL","SANJOAQUIN","SANJOSEDEMIRANDA","SANMIGUEL","SANVICENTEDECHUCURI","SANTABARBARA","SANTAHELENADELOPON","SIMACOTA","SOCORRO","SUAITA","SUCRE","SURATA","TONA","VALLEDESANJOSE","VELEZ","VETAS","VILLANUEVA","ZAPATOCA","SINCELEJO",
                                                   "BUENAVISTA","CAIMITO","COLOSO","COROZAL","COVEÑAS","CHALAN","ELROBLE","GALERAS","GUARANDA","LAUNION","LOSPALMITOS","MAJAGUAL","MORROA","OVEJAS","PALMITO","SAMPUES","SANBENITOABAD","SANJUANDEBETULIA","SANMARCOS","SANONOFRE","SANPEDRO","SANLUISDESINCE","SUCRE","SANTIAGODETOLU","TOLUVIEJO","IBAGUE","ALPUJARRA","ALVARADO","AMBALEMA","ANZOATEGUI","ARMERO","ATACO","CAJAMARCA","CARMENDEAPICALA","CASABIANCA","CHAPARRAL","COELLO","COYAIMA","CUNDAY","DOLORES","ESPINAL","FALAN","FLANDES","FRESNO","GUAMO","HERVEO","HONDA","ICONONZO","LERIDA","LIBANO","MARIQUITA","MELGAR","MURILLO","NATAGAIMA","ORTEGA","PALOCABILDO","PIEDRAS","PLANADAS","PRADO","PURIFICACION","RIOBLANCO","RONCESVALLES","ROVIRA","SALDAÑA","SANANTONIO","SANLUIS","SANTAISABEL","SUAREZ","VALLEDESANJUAN",
                                                   "VENADILLO","VILLAHERMOSA","VILLARRICA","CALI","ALCALA","ANDALUCIA","ANSERMANUEVO","ARGELIA","BOLIVAR","BUENAVENTURA","GUADALAJARADEBUGA","BUGALAGRANDE","CAICEDONIA","CALIMA","CANDELARIA","CARTAGO","DAGUA","ELAGUILA","ELCAIRO","ELCERRITO","ELDOVIO","FLORIDA","GINEBRA","GUACARI","JAMUNDI","LACUMBRE","LAUNION","LAVICTORIA","OBANDO","PALMIRA","PRADERA","RESTREPO","RIOFRIO","ROLDANILLO","SANPEDRO","SEVILLA","TORO","TRUJILLO","TULUA","ULLOA","VERSALLES","VIJES","YOTOCO","YUMBO","ZARZAL","ARAUCA","ARAUQUITA","CRAVONORTE","FORTUL","PUERTORONDON","SARAVENA","TAME","YOPAL","AGUAZUL","CHAMEZA","HATOCOROZAL","LASALINA","MANI","MONTERREY","NUNCHIA","OROCUE","PAZDEARIPORO","PORE","RECETOR","SABANALARGA","SACAMA","SANLUISDEPALENQUE","TAMARA","TAURAMENA","TRINIDAD",
                                                   "VILLANUEVA","MOCOA","COLON","ORITO","PUERTOASIS","PUERTOCAICEDO","PUERTOGUZMAN","LEGUIZAMO","SIBUNDOY","SANFRANCISCO","SANMIGUEL","SANTIAGO","VALLEDELGUAMUEZ","VILLAGARZON","SANANDRES","PROVIDENCIA","LETICIA","ELENCANTO","LACHORRERA","LAPEDRERA","LAVICTORIA","MIRITI-PARANA","PUERTOALEGRIA","PUERTOARICA","PUERTONARIÑO","PUERTOSANTANDER","TARAPACA","INIRIDA","BARRANCOMINAS","MAPIRIPANA","SANFELIPE","PUERTOCOLOMBIA","LAGUADALUPE","CACAHUAL","PANAPANA","MORICHAL","SANJOSEDELGUAVIARE","CALAMAR","ELRETORNO","MIRAFLORES","MITU","CARURU","PACOA","TARAIRA","PAPUNAUA","YAVARATE","PUERTOCARREÑO","LAPRIMAVERA","SANTAROSALIA","CUMARIBO"))
colnames(prueba_c)[50] <- "regimen_salud"
prueba_c$regimen_salud <- factor(prueba_c$regimen_salud, levels = c(1:5),labels =c("contributivo","subsidiado","excepcion","especial","ninguno"), ordered = TRUE)
# Borrar 51, es la calse administradora
# borrar 52, es para saber si la hora era desconocida
# borrar 53, es la fecha de registro
# borrar 54, es un error, la columna está vacía
colnames(prueba_c)[55] <- "año_nacimiento_o_defuncion"
colnames(prueba_c)[56] <- "edad_gestacional_calculada"
colnames(prueba_c)[57] <- "fecha_probable_concepcion"
colnames(prueba_c)[58] <- "año_concepcion"

nacidos <- prueba_c[c(-6,-9,-11,-13,-14,-17,-20,-21,-23,-24,-29,-30,-36:-38,-42,-44:-48,-51:-54)]
nacidos <- setorder(nacidos,madre_id)

nacidos_dg <- subset(nacidos,nacidos$año_concepcion > 2010 & nacidos$año_concepcion != 2010 |is.na(nacidos$año_concepcion) == TRUE)

# Borrar los insumos
rm(prueba_c)
rm(naci_1)
rm(naci_2)


# aquí empieza a trabajarse con la base completa ######################

completa <- rbind.fill(nacidos,defunciones_para_rbind)
completa$fecha_nac_def <- substring(completa$fecha_nac_def,0,10)
completa$fecha_nac_def <- as.Date(completa$fecha_nac_def)

completa$nacido_vivo[is.na(completa$nacido_vivo)==TRUE] <- "no"

# Arreglo el formato de las fechas
completa$fecha_expedicion <- as.Date(completa$fecha_expedicion)


# Vamos a trabajar multiplicidad ###

# Creo un set con los madre id que se repiten 

multiples <- completa %>% group_by(madre_id) %>% filter(n()>1)
multiples <- setorder(multiples, madre_id)

multiples_m <- subset(multiples, multiples$multiplicidad!="simple")


# Imitación del problema de stata para ver que es lo que ellos hacen ######

completa_dg <- subset(completa,completa$fecha_probable_concepcion>"2010-12-31"|is.na(completa$fecha_probable_concepcion)==TRUE)
completa_dg <- setorder(completa_dg, madre_id)

# Esta es la base que ellos usan para ver los múltiples

completa_dg$educ_madre_num <- as.numeric(completa_dg$educ_madre)
completa_dg$multiplicidad_num <- as.numeric(completa_dg$multiplicidad)
completa_dg$estado_conyugal_num <- as.numeric(completa_dg$estado_conyugal)
completa_dg$regimen_salud_num <- as.numeric(completa_dg$regimen_salud)
colnames(completa_dg)[23] <- "edad_materna_num" 

# Loop de stata (más eficiente hacer un bucle, sin embargo no pude)

rm(list=setdiff(ls(), c("completa_dg","moda")))

# Prueba de que funciona con 1000 observaciones

completa_dg_1 <- completa_dg[1:10000,]
completa_dg_1 <- completa_dg_1[c(1,18,23,46:49)]

completa_dg_1 <- completa_dg_1 %>%
  group_by(madre_id,fecha_nac_def) %>%
  dplyr::mutate(across(contains("_num"),
         .fns = list(~moda(.))))

# Correr el código con toda la base

completa_dg_num <- completa_dg %>%
  group_by(madre_id,fecha_nac_def) %>%
  dplyr::mutate(across(contains("_num"),
                       .fns = list(~moda(.))))


# Otra opción, parecen igual de eficientes (son lentos ambos)

# completa_dg[,50:54] = lapply(completa_dg[c(23,46:49)], function(a) ave(a, completa_dg$madre_id,completa_dg$fecha_nac_def, FUN = moda))


# Dejar solo la base de 4 887 443 observaciones para la id de embarazos múltiples ####
 
rm(list=setdiff(ls(), c("completa_dg_num")))


# Identificación de los embarazos múltiples como el Dr Giancarlo

completa_dg_num$total_veces <- 1

completa_dg_num <- completa_dg_num %>% 
  group_by(madre_id) %>%
    dplyr::mutate(sum(total_veces)) 
colnames(completa_dg_num)[56] <- "total_embarazos_por_id"

completa_dg_num <- completa_dg_num %>% 
  group_by(fecha_nac_def,madre_id) %>%
  dplyr::mutate(sum(total_veces))
colnames(completa_dg_num)[57] <- "total_embarazos_por_fecha"


# La copio

copia <- completa_dg_num


table(copia$total_embarazos_por_id)
table(copia$total_embarazos_por_fecha)


# En esta base tenemos una variable que es el número probable de embarazos por id
# y otra,que es el número de embarazos probable de la misma madre por id y por fecha


# La regla de identificación de embarazaos que siguieron en STATA

# Genera una variable que es la resta entre multiplicidad y número de embarazos por fecha

copia$dif_mul_par <- copia$multiplicidad_num_1 - copia$total_embarazos_por_fecha

# aquí generó una variable que son las muertes fetales por fecha
 
copia$muerte_fetal <- NA
copia$muerte_fetal[copia$nacido_vivo=="no"] <- 1
copia$muerte_fetal[copia$nacido_vivo=="si"] <- 0

copia <- copia %>% 
  group_by(fecha_nac_def,madre_id) %>%
  dplyr::mutate(sum(muerte_fetal))
colnames(copia)[60] <- "total_muertes_fetales_por_fecha_id"

# Generar una variable que es la resta entre la multiplicidad y el numero de muertes fetales por día

copia$dif_mul_mfetal <- copia$multiplicidad_num_1 - copia$total_muertes_fetales_por_fecha_id

# Genero una variable que es dicotomica, 1 si el numbero de embarazos por día fue de dos o más y 0 si fue solo 1 embarazo por día

copia$embarazo_repetido_dia[copia$total_embarazos_por_fecha>1 & is.na(copia$total_embarazos_por_fecha)==FALSE] <- 1 
copia$embarazo_repetido_dia[copia$total_embarazos_por_fecha==1 ] <- 0 

table(copia$dif_mul_par,copia$embarazo_repetido_dia)

 0       1
-4       0       8
-2       0     187
-1       0    5888
 0  4730076   80367
 1     4651      48
 2      629       4
 3      460     154
 4    64859       0

 table(copia$total_embarazos_por_fecha,copia$embarazo_repetido_dia)
 
 0       1
 1 4800787       0
 2       0   84698
 3       0    1719
 4       0     220
 5       0       5
 6       0       6
 8       0       8

 table(copia$total_muertes_fetales_por_fecha_id, copia$embarazo_repetido_dia)
 
 0       1
 0 4479492   76558
 1  321295    5168
 2       0    4754
 3       0     162
 4       0      14
 
 table(copia$total_embarazos_por_fecha[copia$embarazo_repetido_dia==1], copia$total_muertes_fetales_por_fecha_id[copia$embarazo_repetido_dia==1])
 
 0     1     2     3     4
 2 75286  4942  4470     0     0
 3  1236   210   120   153     0
 4    36    16   164     4     0
 5     0     0     0     5     0
 6     0     0     0     0     6
 8     0     0     0     0     8 
 
 
 
 
    
 
# Eliminar las observaciones que se concibieron por fuera del periodo de estudio
 
completa_periodo <-completa[completa$fecha_probable_concepcion < "2017-12-31" & completa$fecha_probable_concepcion > "2013-01-01",]
completa_periodo_NA <- subset(completa_periodo,is.na(completa_periodo$madre_id)==TRUE)
completa_periodo <- subset(completa_periodo,is.na(completa_periodo$madre_id)==FALSE)

# Borrar insumos

rm(cohorte_nacimientos_dg)
rm(completa)
rm(nacidos)
rm(defunciones_para_rbind)

sapply(completa_periodo,function(x)table(is.na(x)))


# ME parece eliminar la 6 (corregimiento-inspeccion o caserio), la 29 (otrocenreshab, todo NA, revisar), 

## Ver multiples con completa_periodo




# Ahora se generará la cohorte de niños con muertes después del nacimiento, un mes después:
  
defunciones$in_mad <- NA
defunciones$in_mad[defunciones$MadreID != 1] <- 1 # los que no tienen id materno tienen 1
defunciones$in_mad[is.na(defunciones$in_mad) == TRUE] <- 0
defunciones$muerte_fetal <- NA
defunciones$muerte_fetal[defunciones$in_mad==1 & defunciones$IDTIPODEFUNC== 1] <- 1 #las muertes fetales que tienen id materno
defunciones$muerte_fetal[is.na(defunciones$muerte_fetal) == TRUE] <- 0 
cohorte_ninos_menor1 <- subset(defunciones, defunciones$muerte_fetal !=1) # una cohorte de individuos que no son muertes fetales
cohorte_ninos_menor1$edad_meses <- (cohorte_ninos_menor1$FECHORDEF-cohorte_ninos_menor1$FECHNACIFALL)
cohorte_ninos_menor1$edad_meses <- round(cohorte_ninos_menor1$edad_meses/2.628e6, digits = 2)
muerte_menor1 <- subset(cohorte_ninos_menor1, cohorte_ninos_menor1$in_mad ==1)
muerte_menor1 <- subset(muerte_menor1, muerte_menor1$EDADFALLE <= 1) # 7007 observaciones
muerte_menor2 <- subset(cohorte_ninos_menor1, cohorte_ninos_menor1$edad_meses <1) # 33473 observaciones

# En el anterior chunk se ven dos formas de hacer la cohorte de defunciones perinatales en aquellos que no tenían ID madre y que no estaban clasificados como muerte fetal. Una es utilizando la edad de fallecimiento registrada (muerte_menor1)Otra es creando una variable de edad en meses a partir de la fecha de defunción y la fecha de nacimiento (muerte_menor2)

# Con el id materno hacer merge con los nacidos vivos, fecha de nacimiento (nacidos vivos) y fecha de defuncion. 

# Supuesto: lo que no murieron siguen vivos. 



## Creación cohorte de mujeres embarazadas a partir de los nacimientos:

# Esta es la base de nacimientos de 2011 a 2016:
  
nacimientos_1 <- read_delim("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/ExtraccionNacimientosND2011-2016.txt", 
                            "|", escape_double = FALSE, trim_ws = TRUE)
# Esta es la de 2017-2019
nacimientos_2 <- read_delim("D:/Maestría/Trabajo de Grado/Trabajo de grado en epidemiología/ExtraccionNacimientosND2017_2018_2019.txt", 
                            "|", escape_double = FALSE, trim_ws = TRUE)

# Uno las dos bases

nacimientos <- rbind(nacimientos_1,nacimientos_2)


# Ahora creo una base con los nacimientos de 2013 al 2018
nacimientos2 <- subset(nacimientos, nacimientos$FECHORNAC < "2018-01-01" & nacimientos$FECHORNAC > "2013-01-01")

cohorte <- nacimientos2 %>% left_join(cohorte_defunc,by = c("PersonaID" ="MadreID"))

(3058996+217856) - 3066583

# Estas son las repetidas de ambas bases. 

